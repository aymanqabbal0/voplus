"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7027],{7027:($n,le,D)=>{D.r(le),D.d(le,{VehiclesPageModule:()=>Gn});var y=D(177),u=D(4341),_=D(4742),ce=D(8986),e=D(3953),d=D(467),b=D(4319),R=D(5312),de=D(2284);function L(i,s){return(L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(o,t){return o.__proto__=t,o})(i,s)}function U(){U=function(r,l){return new o(r,void 0,l)};var i=RegExp.prototype,s=new WeakMap;function o(n,r,l){var c=RegExp(n,r);return s.set(c,l||s.get(n)),L(c,o.prototype)}function t(n,r){var l=s.get(r);return Object.keys(l).reduce(function(c,a){var m=l[a];if("number"==typeof m)c[a]=n[m];else{for(var p=0;void 0===n[m[p]]&&p+1<m.length;)p++;c[a]=n[m[p]]}return c},Object.create(null))}return function me(i,s){if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(s&&s.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),s&&L(i,s)}(o,RegExp),o.prototype.exec=function(n){var r=i.exec.call(this,n);if(r){r.groups=t(r,this);var l=r.indices;l&&(l.groups=t(l,this))}return r},o.prototype[Symbol.replace]=function(n,r){if("string"==typeof r){var l=s.get(this);return i[Symbol.replace].call(this,n,r.replace(/\$<([^>]+)>/g,function(a,m){var p=l[m];return"$"+(Array.isArray(p)?p.join("$"):p)}))}if("function"==typeof r){var c=this;return i[Symbol.replace].call(this,n,function(){var a=arguments;return"object"!=(0,de.A)(a[a.length-1])&&(a=[].slice.call(a)).push(t(a,c)),r.apply(this,a)})}return i[Symbol.replace].call(this,n,r)},U.apply(this,arguments)}var se=D(1889),B=D(3426);let ae=(()=>{var i;class s{constructor(t,n){this.httpService=t,this.gs=n}getCities(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getData(b.Y.API_GET_CITY,{}).then(c=>{"success"===(null==c?void 0:c.result)&&(t.cities=null==c?void 0:c.data,console.log(t.cities)),r(t.cities)},l)})})()}getCustomers(t="",n=1){var r=this;return(0,d.A)(function*(){return yield new Promise((c,a)=>{r.httpService.getData(b.Y.API_GET_CUSTOMERS,{search:t,page:n}).then(m=>{"success"===(null==m?void 0:m.result)&&(r.customers=null==m?void 0:m.data,console.log(r.customers)),c(r.customers)},a)})})()}getCustomerById(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.getData(b.Y.API_GET_CUSTOMER+"/"+t,{}).then(a=>{"success"===(null==a?void 0:a.result)&&(n.customer=null==a?void 0:a.data,console.log(n.customer)),l(n.customer)},c)})})()}getSites(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getData(b.Y.API_GET_SITE,{}).then(c=>{var a;"success"===(null==c?void 0:c.result)&&(t.sites=null==c||null===(a=c.data)||void 0===a?void 0:a.filter(({site_id:m})=>{var p;return null===(p=t.gs.userSite)||void 0===p?void 0:p.some(h=>h===m)})),r(t.sites)},l)})})()}postNewCustomer(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.postData(b.Y.API_ADD_CUSTOMER,t).then(a=>{n.responseCreation=a,n.gs.toastMessage(null==a?void 0:a.message),l(n.responseCreation)},c)})})()}editCustomer(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.putData(b.Y.API_EDIT_CUSTOMER,t).then(a=>{n.responseEditing=a,n.gs.toastMessage(null==a?void 0:a.message),l(n.responseEditing)},c)})})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.KVO(se.s),e.KVO(B.O))},i.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"}),s})();function _e(i,s){if(1&i&&(e.j41(0,"option",35),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.site_id),e.R7$(),e.SpI(" ",o.site_name," ")}}function ve(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Veuillez choisir le site concern\xe9 ! "),e.k0s())}function pe(i,s){if(1&i&&(e.j41(0,"option",35),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.city_id),e.R7$(),e.SpI(" ",o.city_name," ")}}function fe(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Veuillez s\xe9l\xe9ctionner le type de client ! "),e.k0s())}function he(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Veuillez ins\xe9rer le nom de la soci\xe9t\xe9! "),e.k0s())}function ge(i,s){if(1&i&&(e.j41(0,"div",5)(1,"label"),e.EFF(2,"Nom de la soci\xe9t\xe9"),e.k0s(),e.nrm(3,"input",37),e.DNE(4,he,2,0,"div",9),e.k0s()),2&i){const o=e.XpG(2);e.R7$(4),e.Y8G("ngIf",o.customerForm.get("customer_ste").invalid&&(o.customerForm.get("customer_ste").dirty||o.customerForm.get("customer_ste").touched))}}function Ce(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Veuillez ins\xe9rer le nom du client ! "),e.k0s())}function Fe(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Veuillez ins\xe9rer le pr\xe9nom du client ! "),e.k0s())}function be(i,s){1&i&&(e.j41(0,"div",36),e.EFF(1," Num\xe9ro de t\xe9l\xe9phone invalide ! "),e.k0s())}function ke(i,s){1&i&&(e.j41(0,"div",5)(1,"label"),e.EFF(2,"RC"),e.k0s(),e.nrm(3,"input",38),e.k0s())}function ye(i,s){1&i&&(e.j41(0,"div",5)(1,"label"),e.EFF(2,"ICE"),e.k0s(),e.nrm(3,"input",39),e.k0s())}function Ee(i,s){if(1&i){const o=e.RV6();e.j41(0,"form",4),e.bIt("ngSubmit",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onClientSubmit(n.customerForm))}),e.j41(1,"div",5)(2,"label"),e.EFF(3,"Site"),e.k0s(),e.j41(4,"select",6),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onSiteChange())}),e.j41(5,"option",7),e.EFF(6,"--"),e.k0s(),e.DNE(7,_e,2,2,"option",8),e.k0s(),e.DNE(8,ve,2,0,"div",9),e.k0s(),e.j41(9,"div",5)(10,"label"),e.EFF(11,"Ville"),e.k0s(),e.j41(12,"select",10)(13,"option",7),e.EFF(14,"--"),e.k0s(),e.DNE(15,pe,2,2,"option",8),e.k0s()(),e.j41(16,"div",5)(17,"label"),e.EFF(18,"Type de client"),e.k0s(),e.j41(19,"select",11)(20,"option",12),e.EFF(21,"Particulier"),e.k0s(),e.j41(22,"option",13),e.EFF(23,"Professionnel"),e.k0s()(),e.DNE(24,fe,2,0,"div",9),e.k0s(),e.DNE(25,ge,5,1,"div",14),e.j41(26,"div",5)(27,"label"),e.EFF(28,"Civilit\xe9"),e.k0s(),e.j41(29,"select",15)(30,"option",7),e.EFF(31,"--"),e.k0s(),e.j41(32,"option",16),e.EFF(33,"Homme"),e.k0s(),e.j41(34,"option",17),e.EFF(35,"Femme"),e.k0s()()(),e.j41(36,"div",5)(37,"label"),e.EFF(38,"Nom"),e.k0s(),e.nrm(39,"input",18),e.DNE(40,Ce,2,0,"div",9),e.k0s(),e.j41(41,"div",5)(42,"label"),e.EFF(43,"Pr\xe9nom"),e.k0s(),e.nrm(44,"input",19),e.DNE(45,Fe,2,0,"div",9),e.k0s(),e.j41(46,"div",20)(47,"label"),e.EFF(48,"T\xe9l\xe9phone"),e.k0s(),e.j41(49,"div",21)(50,"div",22)(51,"select",23)(52,"option",7),e.EFF(53,"--"),e.k0s(),e.j41(54,"option",24),e.EFF(55,"+212"),e.k0s()()(),e.nrm(56,"input",25),e.k0s(),e.DNE(57,be,2,0,"div",9),e.k0s(),e.j41(58,"div",5)(59,"label"),e.EFF(60,"Adresse"),e.k0s(),e.nrm(61,"input",26),e.k0s(),e.j41(62,"div",27),e.EFF(63," Informations compl\xe9mentaires "),e.k0s(),e.DNE(64,ke,4,0,"div",14)(65,ye,4,0,"div",14),e.j41(66,"div",5)(67,"label"),e.EFF(68,"CIN"),e.k0s(),e.nrm(69,"input",28),e.k0s(),e.j41(70,"div",5)(71,"label"),e.EFF(72,"N\xb0 de permis"),e.k0s(),e.nrm(73,"input",29),e.k0s(),e.j41(74,"div",5)(75,"label"),e.EFF(76,"Commentaire"),e.k0s(),e.nrm(77,"textarea",30),e.k0s(),e.j41(78,"div",31)(79,"div",32)(80,"ion-button",33),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.dismiss({dismissed:!0}))}),e.EFF(81,"Annuler "),e.k0s()(),e.j41(82,"div",32)(83,"ion-button",34),e.EFF(84),e.k0s()()()()}if(2&i){const o=e.XpG();e.Y8G("formGroup",o.customerForm),e.R7$(7),e.Y8G("ngForOf",o.sites),e.R7$(),e.Y8G("ngIf",o.customerForm.get("customer_gender").invalid&&(o.customerForm.get("customer_gender").dirty||o.customerForm.get("customer_gender").touched)),e.R7$(7),e.Y8G("ngForOf",o.cities),e.R7$(9),e.Y8G("ngIf",o.customerForm.get("customer_type").invalid&&(o.customerForm.get("customer_type").dirty||o.customerForm.get("customer_type").touched)),e.R7$(),e.Y8G("ngIf","Professionnel"===o.customerForm.get("customer_type").value),e.R7$(15),e.Y8G("ngIf",o.customerForm.get("customer_l_name").invalid&&(o.customerForm.get("customer_l_name").dirty||o.customerForm.get("customer_l_name").touched)),e.R7$(5),e.Y8G("ngIf",o.customerForm.get("customer_f_name").invalid&&(o.customerForm.get("customer_f_name").dirty||o.customerForm.get("customer_f_name").touched)),e.R7$(12),e.Y8G("ngIf",o.customerForm.get("customer_suffix_phone").invalid&&(o.customerForm.get("customer_suffix_phone").dirty||o.customerForm.get("customer_suffix_phone").touched)),e.R7$(7),e.Y8G("ngIf","Professionnel"===o.customerForm.get("customer_type").value),e.R7$(),e.Y8G("ngIf","Professionnel"===o.customerForm.get("customer_type").value),e.R7$(18),e.Y8G("disabled",!o.customerForm.valid),e.R7$(),e.JRh(o.customerId?"Modifier":"Enregistrer")}}let J=(()=>{var i;class s{constructor(t,n,r,l,c){this.newClientService=t,this.fb=n,this.viewCtrl=r,this.loadingController=l,this.alertController=c,this.customerId=""}onSiteChange(){var t;const n=null===(t=this.sites.find(({site_id:r})=>r===this.customerForm.get("customer_site").value))||void 0===t?void 0:t.site_city;this.customerForm.get("customer_city").setValue(n)}ngOnInit(){var t=this;return(0,d.A)(function*(){t.cities=yield t.newClientService.getCities(),t.sites=yield t.newClientService.getSites(),t.customerId?t.spinner("Chargement ...").then(function(){var r=(0,d.A)(function*(l){var c,a,m,p,h,f,C,w,k,E,N,j,I,S,x,v,T,P,V,A,G,$,O;l.present();const F=yield t.newClientService.getCustomerById(t.customerId),Y=t.getPhone(null===(c=F[0])||void 0===c?void 0:c.customer_phone);t.customerForm=t.fb.group({customer_id:null===(a=F[0])||void 0===a?void 0:a.customer_id,customer_site:[null===(m=F[0])||void 0===m?void 0:m.customer_site,u.k0.required],customer_city:[null===(p=F[0])||void 0===p?void 0:p.customer_city,u.k0.required],customer_l_name:[null===(h=F[0])||void 0===h?void 0:h.customer_l_name,u.k0.required],customer_f_name:[null===(f=F[0])||void 0===f?void 0:f.customer_f_name,u.k0.required],customer_prefix_phone:["+212",u.k0.required],customer_suffix_phone:[Y,[u.k0.required,u.k0.pattern("[1-9]{1}[0-9]{8}")]],customer_phone:"",customer_gender:null===(C=F[0])||void 0===C?void 0:C.customer_gender,customer_cin:null===(w=F[0])||void 0===w?void 0:w.customer_cin,customer_permis:null===(k=F[0])||void 0===k?void 0:k.customer_permis,customer_address:"KIA"===(null==R.c?void 0:R.c.packageKey)?[null===(E=F[0])||void 0===E?void 0:E.customer_address,u.k0.required]:null===(N=F[0])||void 0===N?void 0:N.customer_address,customer_comment:null===(j=F[0])||void 0===j?void 0:j.customer_comment,customer_b_year:null===(I=F[0])||void 0===I?void 0:I.customer_b_year,customer_profession:null===(S=F[0])||void 0===S?void 0:S.customer_profession,customer_email:null===(x=F[0])||void 0===x?void 0:x.customer_email,customer_type:null===(v=F[0])||void 0===v?void 0:v.customer_type,customer_bd_city:null===(T=F[0])||void 0===T?void 0:T.customer_bd_city,customer_canal:null===(P=F[0])||void 0===P?void 0:P.customer_canal,customer_rc:null===(V=F[0])||void 0===V?void 0:V.customer_rc,customer_ice:null===(A=F[0])||void 0===A?void 0:A.customer_ice,customer_ste:null===(G=F[0])||void 0===G?void 0:G.customer_ste,customer_phone2:null===($=F[0])||void 0===$?void 0:$.customer_phone2,customer_last_edit_by:null===(O=F[0])||void 0===O?void 0:O.customer_last_edit_by}),l.dismiss()});return function(l){return r.apply(this,arguments)}}()):t.customerForm=t.fb.group({customer_site:["",u.k0.required],customer_city:["",u.k0.required],customer_l_name:["",u.k0.required],customer_f_name:["",u.k0.required],customer_prefix_phone:["+212",u.k0.required],customer_suffix_phone:["",[u.k0.required,u.k0.pattern("[1-9]{1}[0-9]{8}")]],customer_phone:"",customer_gender:"",customer_cin:"",customer_permis:"",customer_address:"KIA"===(null==R.c?void 0:R.c.packageKey)?["",u.k0.required]:"",customer_comment:"",customer_b_year:"",customer_profession:"",customer_email:"",customer_type:"Particulier",customer_bd_city:"",customer_canal:"",customer_rc:"",customer_ice:"",customer_ste:"",customer_phone2:"",customer_last_edit_by:""})})()}dismiss(t){this.viewCtrl.dismiss(t)}spinner(t){var n=this;return(0,d.A)(function*(){return yield n.loadingController.create({cssClass:"my-custom-class",message:t})})()}getPhone(t){const n=t.split("-");return Number(n[1])}onClientSubmit(t){var n=this;return(0,d.A)(function*(){var r,l;const c=(null===(r=t.get("customer_prefix_phone"))||void 0===r?void 0:r.value)+"-"+String(null===(l=t.get("customer_suffix_phone"))||void 0===l?void 0:l.value);t.controls.customer_phone.setValue(c),console.log("Valid?",t.valid),console.log("Values",t.value),t.valid&&n.customerId?n.spinner("Modification ...").then(function(){var m=(0,d.A)(function*(p){p.present(),yield n.newClientService.editCustomer(t.value),p.dismiss()});return function(p){return m.apply(this,arguments)}}()).finally(()=>{"success"!==n.newClientService.responseEditing.result?n.presentAlert(n.newClientService.responseEditing.message):n.dismiss({edited:!0})}):t.valid&&n.spinner("Envoie ...").then(function(){var m=(0,d.A)(function*(p){p.present(),yield n.newClientService.postNewCustomer(t.value),p.dismiss()});return function(p){return m.apply(this,arguments)}}()).finally(()=>{"success"!==n.newClientService.responseCreation.result?n.presentAlert(n.newClientService.responseCreation.message):n.dismiss({created:!0})})})()}presentAlert(t){var n=this;return(0,d.A)(function*(){yield(yield n.alertController.create({header:"Alert",message:t,buttons:["OK"]})).present()})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(ae),e.rXU(u.ok),e.rXU(_.W3),e.rXU(_.Xi),e.rXU(_.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-new-client"]],inputs:{customerId:"customerId"},decls:7,vars:1,consts:[["color","dark"],["name","arrow-back","slot","start",1,"ms-3",2,"width","24px","height","24px",3,"click"],[1,"row-fluid","px-0","py-2","mx-1",2,"overflow-y","auto"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"ngSubmit","formGroup"],[1,"col-12","px-2","mt-3","form-group"],["formControlName","customer_site","required","",1,"form-control",3,"change"],["value","","disabled",""],[3,"ngValue",4,"ngFor","ngForOf"],["class","text-danger",4,"ngIf"],["formControlName","customer_city","required","",1,"form-control"],["formControlName","customer_type","required","",1,"form-control"],["value","Particulier"],["value","Professionnel"],["class","col-12 px-2 mt-3 form-group",4,"ngIf"],["formControlName","customer_gender",1,"form-control"],["value","Homme"],["value","Femme"],["formControlName","customer_l_name","type","text","aria-label","Text input with dropdown button","required","",1,"form-control"],["formControlName","customer_f_name","type","text","aria-label","Text input with dropdown button","required","",1,"form-control"],[1,"col-12","px-2","form-group"],[1,"input-group","mb-3"],[1,"input-group-prepend","w-25"],["formControlName","customer_prefix_phone",1,"w-100","form-control","rounded-0"],["value","+212"],["formControlName","customer_suffix_phone","type","number","aria-label","Text input with dropdown button","required","",1,"form-control","w-25","rounded-0"],["formControlName","customer_address","type","text","aria-label","Text input",1,"form-control"],[1,"w-100","my-4","h5","text-center"],["formControlName","customer_cin","type","text","aria-label","Text input",1,"form-control"],["formControlName","customer_permis","type","text","aria-label","Text input",1,"form-control"],["formControlName","customer_comment","aria-label","Text input",1,"form-control"],[1,"row","mx-auto"],[1,"col-6"],["expand","block","color","danger",3,"click"],["type","submit","expand","block","color","dark",3,"disabled"],[3,"ngValue"],[1,"text-danger"],["formControlName","customer_ste","type","text","aria-label","Text input with dropdown button","required","",1,"form-control"],["formControlName","customer_rc","type","text","aria-label","Text input",1,"form-control"],["formControlName","customer_ice","type","text","aria-label","Text input",1,"form-control"]],template:function(t,n){1&t&&(e.j41(0,"ion-toolbar",0)(1,"ion-icon",1),e.bIt("click",function(){return n.dismiss({dismissed:!0})}),e.k0s(),e.j41(2,"ion-title"),e.EFF(3," Informations Client "),e.k0s()(),e.j41(4,"ion-content")(5,"div",2),e.DNE(6,Ee,85,13,"form",3),e.k0s()()),2&t&&(e.R7$(6),e.Y8G("ngIf",n.customerForm))},dependencies:[y.Sq,y.bT,u.qT,u.xH,u.y7,u.me,u.Q0,u.wz,u.BC,u.cb,u.YS,_.Jm,_.W9,_.iq,_.BC,_.ai,u.j4,u.JD],styles:[".ng-valid[required][_ngcontent-%COMP%], .ng-valid.required[_ngcontent-%COMP%]{border-left:5px solid #42A948}.ng-invalid[_ngcontent-%COMP%]:not(form){border-left:5px solid #a94442}.alert[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#fed3d3;color:#820000;padding:1rem;margin-bottom:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}select[_ngcontent-%COMP%]{width:100%;padding:.5rem}"]}),s})();function we(i,s){1&i&&e.nrm(0,"ion-icon",10)}function Ne(i,s){1&i&&e.nrm(0,"ion-icon",10)}let je=(()=>{var i;class s{constructor(){}ngOnInit(){}}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.VBU({type:i,selectors:[["app-customer-card"]],inputs:{customer:"customer"},decls:21,vars:12,consts:[[1,"row","mb-2"],[1,"col-12"],[1,"card","border-0","shadow"],[1,"card-body","p-2"],[1,"m-0","p-0","font-10","text-muted",2,"position","absolute","top","0","right","5px"],[1,"m-0","text-truncate"],[1,"d-flex","justify-content-between","text-dark","font-14"],[1,"d-flex","align-items-center"],["name","call","class","mr-1",4,"ngIf"],[1,"d-flex","justify-content-between","text-black-50","font-13"],["name","call",1,"mr-1"]],template:function(t,n){1&t&&(e.j41(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"p",4),e.EFF(5),e.k0s(),e.j41(6,"p",5),e.EFF(7),e.k0s(),e.j41(8,"div",6)(9,"div",7),e.DNE(10,we,1,0,"ion-icon",8),e.EFF(11),e.k0s(),e.j41(12,"div",7),e.DNE(13,Ne,1,0,"ion-icon",8),e.EFF(14),e.k0s()(),e.j41(15,"div",9)(16,"div"),e.EFF(17),e.k0s(),e.j41(18,"div"),e.EFF(19),e.nI1(20,"date"),e.k0s()()()()()()),2&t&&(e.R7$(5),e.SpI(" #",null==n.customer?null:n.customer.customer_ref,""),e.R7$(2),e.Lme(" ",null==n.customer?null:n.customer.customer_f_name," ",null==n.customer?null:n.customer.customer_l_name," "),e.R7$(3),e.Y8G("ngIf",null==n.customer?null:n.customer.customer_phone),e.R7$(),e.SpI(" ",null==n.customer?null:n.customer.customer_phone," "),e.R7$(2),e.Y8G("ngIf",null==n.customer?null:n.customer.customer_phone2),e.R7$(),e.SpI(" ",null==n.customer?null:n.customer.customer_phone2," "),e.R7$(3),e.Lme(" ",null==n.customer?null:n.customer.user_f_name," ",null==n.customer?null:n.customer.user_l_name," "),e.R7$(2),e.SpI(" ",e.bMT(20,10,null==n.customer?null:n.customer.customer_date_create)," "))},dependencies:[y.bT,_.iq,y.vh]}),s})();function Ie(i,s){if(1&i){const o=e.RV6();e.j41(0,"ion-icon",14),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.openModal())}),e.k0s()}}function Se(i,s){if(1&i&&(e.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",15),e.nrm(3,"img",16),e.j41(4,"ion-text",17),e.EFF(5,"Aucune donn\xe9e disponible"),e.k0s()()()()),2&i){const o=e.XpG();e.R7$(4),e.Y8G("color",o.color.sec)}}function xe(i,s){if(1&i){const o=e.RV6();e.j41(0,"app-customer-card",18),e.bIt("click",function(){const n=e.eBV(o).$implicit,r=e.XpG();return e.Njj(r.presentActionSheet(null==n?null:n.customer_id))}),e.k0s()}2&i&&e.Y8G("customer",s.$implicit)}function De(i,s){1&i&&e.nrm(0,"ion-icon",26)}function Re(i,s){1&i&&e.nrm(0,"ion-icon",27)}function Te(i,s){1&i&&e.nrm(0,"ion-icon",26)}function Pe(i,s){if(1&i){const o=e.RV6();e.j41(0,"ion-card",8)(1,"ion-item"),e.nrm(2,"ion-icon",19),e.j41(3,"ion-label"),e.EFF(4),e.k0s(),e.j41(5,"ion-button",20),e.bIt("click",function(n){e.eBV(o);const r=e.XpG();return e.Njj(r.addClient(n))}),e.EFF(6,"Add "),e.k0s(),e.j41(7,"ion-button",21),e.bIt("click",function(n){e.eBV(o);const r=e.XpG();return e.Njj(r.openEditModal(n))}),e.EFF(8,"Edit "),e.k0s()(),e.j41(9,"ion-card-content")(10,"div",22)(11,"div",23)(12,"p")(13,"label"),e.DNE(14,De,1,0,"ion-icon",24),e.EFF(15),e.k0s()(),e.j41(16,"p")(17,"label"),e.DNE(18,Re,1,0,"ion-icon",25),e.EFF(19),e.k0s()()(),e.j41(20,"div",23)(21,"p")(22,"label"),e.DNE(23,Te,1,0,"ion-icon",24),e.EFF(24),e.k0s()()()()()()}if(2&i){const o=s.$implicit;e.R7$(4),e.JRh(o.customer_f_name+" "+o.customer_l_name),e.R7$(),e.Y8G("id",o.customer_id),e.R7$(2),e.Y8G("id",o.customer_id),e.R7$(7),e.Y8G("ngIf",o.customer_phone),e.R7$(),e.SpI(" ",o.customer_phone," "),e.R7$(3),e.Y8G("ngIf",o.city_name),e.R7$(),e.SpI(" ",o.city_name," "),e.R7$(4),e.Y8G("ngIf",o.customer_phone2),e.R7$(),e.SpI(" ",o.customer_phone2," ")}}let Ve=(()=>{var i;class s{constructor(t,n,r,l,c){this.newClientService=t,this.loadingController=n,this.viewCtrl=r,this.actionSheetController=l,this.gs=c,this.env=R.c.conf,this.color=b.Y.COLORS,this.index=1}ngOnInit(){var t=this;return(0,d.A)(function*(){yield t.getItemsAsync()})()}openModal(){var t=this;return(0,d.A)(function*(){t.gs.checkPermission("customer_details");const n=yield t.viewCtrl.create({component:J});return yield n.present().then((0,d.A)(function*(){const{data:r}=yield n.onWillDismiss();r&&r.created&&(yield t.getItemsAsync())}))})()}openEditModal(t){var n=this;return(0,d.A)(function*(){const r=t.target.id;return yield(yield n.viewCtrl.create({component:J,componentProps:{customerId:r}})).present()})()}dismiss(t){var n=this;return(0,d.A)(function*(){yield n.viewCtrl.dismiss(t)})()}spinner(t){var n=this;return(0,d.A)(function*(){return yield n.loadingController.create({cssClass:"my-custom-class",message:t})})()}getItemsAsync(){var t=this;return(0,d.A)(function*(){t.spinner("Chargement ...").then(function(){var r=(0,d.A)(function*(l){l.present(),t.customers=yield t.newClientService.getCustomers(),l.dismiss()});return function(l){return r.apply(this,arguments)}}())})()}loadData(t){var n=this;return(0,d.A)(function*(){setTimeout((0,d.A)(function*(){if(n.index+=1,n.keyWord){const r=yield n.newClientService.getCustomers(n.keyWord,n.index);n.customers=[...n.customers,...r]}else{const r=yield n.newClientService.getCustomers("",n.index);n.customers=[...n.customers,...r]}t.target.complete(),1e3===n.customers.length&&(t.target.disabled=!0)}),500)})()}onClearSearch(){var t=this;return(0,d.A)(function*(){t.keyWord="",t.index=1,t.customers=yield t.newClientService.getCustomers()})()}handleSearch(t){var n=this;return(0,d.A)(function*(){var r;n.keyWord=null==t||null===(r=t.target)||void 0===r?void 0:r.value,n.index=1,n.customers=yield n.newClientService.getCustomers(n.keyWord)})()}handleRefresh(t){var n=this;return(0,d.A)(function*(){n.index=1,n.customers=yield n.newClientService.getCustomers(n.keyWord),t.target.complete()})()}addClient(t){var n;const r=null==t||null===(n=t.target)||void 0===n?void 0:n.id;this.viewCtrl.dismiss({customerId:r})}presentActionSheet(t){var n=this;return(0,d.A)(function*(){var r;const l=[];var p;l.push({text:"S\xe9l\xe9ctionner",icon:"checkmark-circle",handler:(p=(0,d.A)(function*(){n.viewCtrl.dismiss({customerId:t})}),function(){return p.apply(this,arguments)})}),null!==(r=n.env)&&void 0!==r&&null!==(r=r.vehicleOperations)&&void 0!==r&&r.editCustomer&&n.gs.checkPermission("customer_details")&&l.push({text:"Modifier",icon:"pencil",handler:function(){var p=(0,d.A)(function*(){return yield(yield n.viewCtrl.create({component:J,componentProps:{customerId:t}})).present()});return function(){return p.apply(this,arguments)}}()});const c=yield n.actionSheetController.create({buttons:l});yield c.present();const{role:a,data:m}=yield c.onDidDismiss();console.log("onDidDismiss resolved with role and data",a,m)})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(ae),e.rXU(_.Xi),e.rXU(_.W3),e.rXU(_.GD),e.rXU(B.O))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-clients"]],viewQuery:function(t,n){if(1&t&&e.GBs(_.Ax,5),2&t){let r;e.mGM(r=e.lsd())&&(n.infiniteScroll=r.first)}},decls:17,vars:4,consts:[["color","dark"],["name","arrow-back","slot","start",1,"ms-3",2,"width","24px","height","24px",3,"click"],["class","add-icon mr-1 ","slot","end","name","add","style","width: 32px; height: 32px;",3,"click",4,"ngIf"],[1,"ion-padding",2,"overflow-y","auto"],["slot","fixed",3,"ionRefresh"],[1,"d-flex","align-content-start","w-100"],["type","text","debounce","500","placeholder","Search",1,"px-0",3,"ionClear","keyup.enter"],[4,"ngIf"],[1,"w-100"],[3,"customer","click",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."],[1,"row","d-none"],["class","w-100",4,"ngFor","ngForOf"],["slot","end","name","add",1,"add-icon","mr-1",2,"width","32px","height","32px",3,"click"],[1,"text-center"],["src","../../assets/empty.svg","alt","char",1,"char-empty"],[3,"color"],[3,"click","customer"],["name","person","slot","start"],["fill","outline","slot","end",3,"click","id"],["fill","outline","slot","end","color","danger",3,"click","id"],[1,"row"],[1,"col-6"],["name","call",4,"ngIf"],["name","pin",4,"ngIf"],["name","call"],["name","pin"]],template:function(t,n){1&t&&(e.j41(0,"ion-toolbar",0)(1,"ion-icon",1),e.bIt("click",function(){return n.dismiss({dismissed:!0})}),e.k0s(),e.j41(2,"ion-title"),e.EFF(3," Liste des clients "),e.k0s(),e.DNE(4,Ie,1,0,"ion-icon",2),e.k0s(),e.j41(5,"ion-content",3)(6,"ion-refresher",4),e.bIt("ionRefresh",function(l){return n.handleRefresh(l)}),e.nrm(7,"ion-refresher-content"),e.k0s(),e.j41(8,"div",5)(9,"ion-searchbar",6),e.bIt("ionClear",function(){return n.onClearSearch()})("keyup.enter",function(l){return n.handleSearch(l)}),e.k0s()(),e.DNE(10,Se,6,1,"ion-grid",7),e.j41(11,"div",8),e.DNE(12,xe,1,1,"app-customer-card",9),e.j41(13,"ion-infinite-scroll",10),e.bIt("ionInfinite",function(l){return n.loadData(l)}),e.nrm(14,"ion-infinite-scroll-content",11),e.k0s()(),e.j41(15,"div",12),e.DNE(16,Pe,25,9,"ion-card",13),e.k0s()()),2&t&&(e.R7$(4),e.Y8G("ngIf",(null==n.env||null==n.env.vehicleOperations?null:n.env.vehicleOperations.addCustomer)&&n.gs.checkPermission("customer_details")),e.R7$(6),e.Y8G("ngIf",0===(null==n.customers?null:n.customers.length)),e.R7$(2),e.Y8G("ngForOf",n.customers),e.R7$(4),e.Y8G("ngForOf",n.customers))},dependencies:[y.Sq,y.bT,_.Jm,_.b_,_.I9,_.hU,_.W9,_.lO,_.iq,_.Ax,_.Hp,_.uz,_.he,_.To,_.Ki,_.ln,_.S1,_.IO,_.BC,_.ai,_.Gw,je],styles:[".add-icon[_ngcontent-%COMP%]{font-size:40px;margin-right:40px;cursor:pointer}.pointer[_ngcontent-%COMP%]{cursor:pointer}.horizontal-cards[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{display:inline-block;width:256px}"]}),s})(),H=(()=>{var i;class s{constructor(t,n){this.httpService=t,this.gs=n}getCities(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getData(b.Y.API_GET_CITY,{}).then(c=>{"success"===(null==c?void 0:c.result)&&(t.cities=null==c?void 0:c.data,console.log(t.cities)),r(t.cities)},l)})})()}getSites(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getData(b.Y.API_GET_SITE,{}).then(c=>{var a;"success"===(null==c?void 0:c.result)&&(t.sites=null==c||null===(a=c.data)||void 0===a?void 0:a.filter(({site_id:m})=>{var p;return null===(p=t.gs.userSite)||void 0===p?void 0:p.some(h=>h===m)})),r(t.sites)},l)})})()}getCustomers(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getData(b.Y.API_GET_CUSTOMERS,{}).then(c=>{"success"===(null==c?void 0:c.result)&&(t.customers=null==c?void 0:c.data,console.log(t.customers)),r(t.customers)},l)})})()}getBrands(){var t=this;return(0,d.A)(function*(){return yield new Promise((r,l)=>{t.httpService.getDataSSO(b.Y.API_BRANDS,{}).then(c=>{"success"===(null==c?void 0:c.result)&&(t.brands=null==c?void 0:c.data,console.log(t.brands)),r(t.brands)},l)})})()}getBrandsByDate(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_BRAND_DATE,{date:t}).then(a=>{"success"===(null==a?void 0:a.result)&&(n.brands=null==a?void 0:a.data,console.log(n.brands)),l(n.brands)},c)})})()}getModels(t,n){var r=this;return(0,d.A)(function*(){return yield new Promise((c,a)=>{r.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_MODEL,{brand:t,date:n}).then(m=>{"success"===(null==m?void 0:m.result)&&(r.models=null==m?void 0:m.data,console.log(r.models)),c(r.models)},a)})})()}getFuelTypes(t,n,r){var l=this;return(0,d.A)(function*(){return yield new Promise((a,m)=>{l.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_FUEL,{brand:t,date:n,model:r}).then(p=>{"success"===(null==p?void 0:p.result)&&(l.fuelTypes=null==p?void 0:p.data),a(l.fuelTypes)},m)})})()}getTransTypes(t,n,r,l){var c=this;return(0,d.A)(function*(){return yield new Promise((m,p)=>{c.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_TRANSMISSION,{brand:t,date:n,model:r,fuel:l}).then(h=>{"success"===(null==h?void 0:h.result)&&(c.trans=null==h?void 0:h.data,console.log(c.trans)),m(c.trans)},p)})})()}getFiscalPower(t,n,r,l,c){var a=this;return(0,d.A)(function*(){return yield new Promise((p,h)=>{a.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_FISCAL,{brand:t,date:n,model:r,fuel:l,transmission:c}).then(f=>{"success"===(null==f?void 0:f.result)&&(a.fiscalPower=null==f?void 0:f.data,console.log(a.fiscalPower)),p(a.fiscalPower)},h)})})()}getFinition(t,n,r,l,c,a){var m=this;return(0,d.A)(function*(){return yield new Promise((h,f)=>{m.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_FINITION,{brand:t,date:n,model:r,fuel:l,transmission:c,pf:a}).then(C=>{"success"===(null==C?void 0:C.result)&&(m.fin=null==C?void 0:C.data,console.log(m.fin)),h(m.fin)},f)})})()}getFinitionData(t){var n=this;return(0,d.A)(function*(){return n.httpService.getDataSSO(b.Y.API_FILTER_ADVANCED_FINITION_FULL_DATA,{finition:t})})()}getVehicles(t="",n=1,r="",l="",c="",a=""){var m=this;return(0,d.A)(function*(){return yield new Promise((h,f)=>{m.httpService.getData(b.Y.API_GET_VEHICLE,{search:t,page:n}).then(C=>{"success"===(null==C?void 0:C.result)&&(m.vehicles=null==C?void 0:C.data,console.log(m.vehicles)),h(m.vehicles)},f)})})()}getVehicleById(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.getData(b.Y.API_GET_VEHICLE+"/"+t,{}).then(a=>{"success"===(null==a?void 0:a.result)&&(n.vehicle=null==a?void 0:a.data,console.log(n.vehicle)),l(n.vehicle)},c)})})()}getOwnerById(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.getData(b.Y.API_GET_CUSTOMER+"/"+t,{}).then(a=>{"success"===(null==a?void 0:a.result)&&(n.owner=null==a?void 0:a.data,console.log(n.owner)),l(n.owner)},c)})})()}postNewCar(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.postData(b.Y.API_ADD_VEHICLE,t).then(a=>{n.responseCreation=a,n.gs.toastMessage(null==a?void 0:a.message),l(n.responseCreation)},c)})})()}editCar(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.putData(b.Y.API_EDIT_VEHICLE+"/"+(null==t?void 0:t.vehicle_id),t).then(a=>{n.responseEditing=a,n.gs.toastMessage(null==a?void 0:a.message),l(n.responseEditing)},c)})})()}getExpertsBySiteId(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.getData(b.Y.API_GET_EXPERT_SITE_VEHICLE,{site_id:t}).then(a=>{"success"===(null==a?void 0:a.result)&&(n.experts=null==a?void 0:a.data,console.log(n.experts)),l(n.experts)},c)})})()}addOp(t){var n=this;return(0,d.A)(function*(){return yield new Promise((l,c)=>{n.httpService.postData(b.Y.API_ADD_EXPERTISE,t).then(a=>{n.responseOp=a,n.gs.toastMessage(null==a?void 0:a.message),l(n.responseOp)},c)})})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.KVO(se.s),e.KVO(B.O))},i.\u0275prov=e.jDH({token:i,factory:i.\u0275fac,providedIn:"root"}),s})();function Ae(i,s){if(1&i&&(e.j41(0,"div",6),e.nrm(1,"ion-img",7),e.k0s()),2&i){const o=e.XpG();e.R7$(),e.Y8G("src",o.brandLogo)}}function Ge(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez choisir le client concern\xe9 ! "),e.k0s())}function $e(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.site_id),e.R7$(),e.SpI(" ",o.site_name," ")}}function Oe(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez choisir le site concern\xe9 ! "),e.k0s())}function Ye(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner la date de mise en circulation ! "),e.k0s())}function Me(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o.brand_name," ")}}function qe(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner la marque du v\xe9hicule ! "),e.k0s())}function Xe(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function Be(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner le mod\xe8le du v\xe9hicule ! "),e.k0s())}function Ue(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function We(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner le carburant ! "),e.k0s())}function Le(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function Je(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner la transmission ! "),e.k0s())}function He(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function ze(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner la puissance fiscale ! "),e.k0s())}function Ke(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function Ze(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez s\xe9lectionner la finition ! "),e.k0s())}function Qe(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez indiquer le couleur ! "),e.k0s())}function en(i,s){if(1&i&&(e.j41(0,"div",9)(1,"label"),e.EFF(2,"Couleur"),e.k0s(),e.nrm(3,"input",56),e.DNE(4,Qe,2,0,"div",11),e.k0s()),2&i){let o;const t=e.XpG(2);e.R7$(4),e.Y8G("ngIf",(null==(o=t.carForm.get("vehicle_couleur"))?null:o.invalid)&&((null==(o=t.carForm.get("vehicle_couleur"))?null:o.dirty)||(null==(o=t.carForm.get("vehicle_couleur"))?null:o.touched)))}}function nn(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez indiquer un prix correct ! "),e.k0s())}function tn(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Kilom\xe9trage maximum exc\xe9d\xe9 ! "),e.k0s())}function on(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Le VIN n'est pas correctement inser\xe9 ! "),e.k0s())}function rn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o),e.R7$(),e.SpI(" ",o," ")}}function ln(i,s){1&i&&e.nrm(0,"input",57)}function cn(i,s){1&i&&(e.j41(0,"div",54),e.EFF(1," Veuillez choisir un num\xe9ro d'immatriculation valide ! "),e.k0s())}function sn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.prev_id),e.R7$(),e.SpI(" ",o.prev_value," ")}}function an(i,s){1&i&&(e.j41(0,"div",48)(1,"label"),e.EFF(2,"Date de d\xe9douanement"),e.k0s(),e.nrm(3,"input",58),e.k0s())}function un(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function dn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function mn(i,s){1&i&&(e.j41(0,"div",25)(1,"label"),e.EFF(2,"Date de derni\xe9re mutation"),e.k0s(),e.nrm(3,"input",59),e.k0s())}function _n(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function vn(i,s){1&i&&(e.j41(0,"div",25)(1,"label"),e.EFF(2,"Date de dernier visite technique"),e.k0s(),e.nrm(3,"input",60),e.k0s())}function pn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function fn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function hn(i,s){1&i&&(e.j41(0,"div",25)(1,"label"),e.EFF(2,"Date de fin de garantie"),e.k0s(),e.nrm(3,"input",61),e.k0s())}function gn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function Cn(i,s){1&i&&(e.j41(0,"div",48)(1,"label"),e.EFF(2,"Organisme de financement"),e.k0s(),e.nrm(3,"input",62),e.k0s())}function Fn(i,s){1&i&&(e.j41(0,"div",48)(1,"label"),e.EFF(2,"Montant restant d\xfb"),e.k0s(),e.nrm(3,"input",63),e.k0s())}function bn(i,s){if(1&i&&(e.j41(0,"option",55),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.back),e.R7$(),e.SpI(" ",o.front," ")}}function kn(i,s){if(1&i){const o=e.RV6();e.j41(0,"form",8),e.bIt("ngSubmit",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onVehicleSubmit(n.carForm))}),e.j41(1,"div",9)(2,"label"),e.EFF(3,"Propri\xe9taire"),e.k0s(),e.j41(4,"input",10),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.openModal())}),e.k0s(),e.DNE(5,Ge,2,0,"div",11),e.k0s(),e.j41(6,"div",9)(7,"label"),e.EFF(8,"Site"),e.k0s(),e.j41(9,"select",12)(10,"option",13),e.EFF(11,"--"),e.k0s(),e.DNE(12,$e,2,2,"option",14),e.k0s(),e.DNE(13,Oe,2,0,"div",11),e.k0s(),e.j41(14,"div",9)(15,"label"),e.EFF(16,"Ann\xe9e"),e.k0s(),e.j41(17,"input",15),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onDateChange(n.carForm.value.vehicle_date_mec))}),e.k0s(),e.DNE(18,Ye,2,0,"div",11),e.k0s(),e.j41(19,"div",9)(20,"label"),e.EFF(21,"Marque"),e.k0s(),e.j41(22,"select",16),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onBrandChange(n.carForm.value.vehicle_brand))}),e.j41(23,"option",13),e.EFF(24,"--"),e.k0s(),e.DNE(25,Me,2,2,"option",14),e.k0s(),e.DNE(26,qe,2,0,"div",11),e.k0s(),e.j41(27,"div",9)(28,"label"),e.EFF(29,"Mod\xe8le"),e.k0s(),e.j41(30,"select",17),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onModelChange(n.carForm.value.vehicle_brand.brand_name,n.carForm.value.vehicle_model))}),e.j41(31,"option",13),e.EFF(32,"--"),e.k0s(),e.DNE(33,Xe,2,2,"option",14),e.k0s(),e.DNE(34,Be,2,0,"div",11),e.k0s(),e.j41(35,"div",9)(36,"label"),e.EFF(37,"Carburant"),e.k0s(),e.j41(38,"select",18),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onFuelChange(n.carForm.value.vehicle_brand.brand_name,n.carForm.value.vehicle_model,n.carForm.value.vehicle_fuel))}),e.j41(39,"option",13),e.EFF(40,"--"),e.k0s(),e.DNE(41,Ue,2,2,"option",14),e.k0s(),e.DNE(42,We,2,0,"div",11),e.k0s(),e.j41(43,"div",9)(44,"label"),e.EFF(45,"Transmission"),e.k0s(),e.j41(46,"select",19),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onTransChange(n.carForm.value.vehicle_brand.brand_name,n.carForm.value.vehicle_model,n.carForm.value.vehicle_fuel,n.carForm.value.vehicle_type_v))}),e.j41(47,"option",13),e.EFF(48,"--"),e.k0s(),e.DNE(49,Le,2,2,"option",14),e.k0s(),e.DNE(50,Je,2,0,"div",11),e.k0s(),e.j41(51,"div",9)(52,"label"),e.EFF(53,"Puissance fiscale"),e.k0s(),e.j41(54,"select",20),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onFiscalChange(n.carForm.value.vehicle_brand.brand_name,n.carForm.value.vehicle_model,n.carForm.value.vehicle_fuel,n.carForm.value.vehicle_type_v,n.carForm.value.vehicle_pf))}),e.j41(55,"option",13),e.EFF(56,"--"),e.k0s(),e.DNE(57,He,2,2,"option",14),e.k0s(),e.DNE(58,ze,2,0,"div",11),e.k0s(),e.j41(59,"div",9)(60,"label"),e.EFF(61,"Finition"),e.k0s(),e.j41(62,"select",21),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.getFinitionDataRef())}),e.j41(63,"option",13),e.EFF(64,"--"),e.k0s(),e.DNE(65,Ke,2,2,"option",14),e.k0s(),e.DNE(66,Ze,2,0,"div",11),e.k0s(),e.j41(67,"div",22),e.EFF(68," Informations compl\xe9mentaires "),e.k0s(),e.DNE(69,en,5,1,"div",23),e.j41(70,"div",9)(71,"label"),e.EFF(72,"Prix souhait\xe9 par le client"),e.k0s(),e.nrm(73,"input",24),e.DNE(74,nn,2,0,"div",11),e.k0s(),e.j41(75,"div",25)(76,"label"),e.EFF(77,"Kilom\xe9trage"),e.k0s(),e.nrm(78,"input",26),e.DNE(79,tn,2,0,"div",11),e.k0s(),e.j41(80,"div",9)(81,"label"),e.EFF(82,"VIN"),e.k0s(),e.nrm(83,"input",27),e.DNE(84,on,2,0,"div",11),e.k0s(),e.j41(85,"div",9)(86,"label"),e.EFF(87,"Num\xe9ro d'immatriculation"),e.k0s(),e.j41(88,"div",28)(89,"div",29),e.nrm(90,"input",30),e.j41(91,"select",31)(92,"option",13),e.EFF(93,"--"),e.k0s(),e.DNE(94,rn,2,2,"option",14),e.k0s()(),e.DNE(95,ln,1,0,"input",32),e.k0s(),e.DNE(96,cn,2,0,"div",11),e.k0s(),e.j41(97,"div",9)(98,"label"),e.EFF(99,"Origine V\xe9hicule"),e.k0s(),e.j41(100,"select",33)(101,"option",34),e.EFF(102,"Je ne sais pas"),e.k0s(),e.j41(103,"option",35),e.EFF(104,"D\xe9douan\xe9"),e.k0s(),e.j41(105,"option",36),e.EFF(106,"Import\xe9 neuf"),e.k0s(),e.j41(107,"option",37),e.EFF(108,"WW Maroc"),e.k0s()()(),e.j41(109,"div",9)(110,"label"),e.EFF(111,"Provenance"),e.k0s(),e.j41(112,"select",38),e.DNE(113,sn,2,2,"option",14),e.k0s()(),e.DNE(114,an,4,0,"div",39),e.j41(115,"div",25)(116,"label"),e.EFF(117,"V\xe9hicule 1"),e.j41(118,"small"),e.EFF(119,"er"),e.k0s(),e.EFF(120," main"),e.k0s(),e.j41(121,"select",40)(122,"option",34),e.EFF(123,"Je ne sais pas"),e.k0s(),e.DNE(124,un,2,2,"option",14),e.k0s()(),e.j41(125,"div",9)(126,"label"),e.EFF(127,"TVA r\xe9cup\xe9rable"),e.k0s(),e.j41(128,"select",41)(129,"option"),e.EFF(130,"--"),e.k0s(),e.DNE(131,dn,2,2,"option",14),e.k0s()(),e.DNE(132,mn,4,0,"div",42),e.j41(133,"div",25)(134,"label"),e.EFF(135,"Cetrificat de la visite technique"),e.k0s(),e.j41(136,"select",43)(137,"option",34),e.EFF(138,"Je ne sais pas"),e.k0s(),e.DNE(139,_n,2,2,"option",14),e.k0s()(),e.DNE(140,vn,4,0,"div",42),e.j41(141,"div",25)(142,"label"),e.EFF(143,"Carnet d'entretien disponible"),e.k0s(),e.j41(144,"select",44)(145,"option",34),e.EFF(146,"Je ne sais pas"),e.k0s(),e.DNE(147,pn,2,2,"option",14),e.k0s()(),e.j41(148,"div",25)(149,"label"),e.EFF(150,"Garantie en cours"),e.k0s(),e.j41(151,"select",45)(152,"option",34),e.EFF(153,"Je ne sais pas"),e.k0s(),e.DNE(154,fn,2,2,"option",14),e.k0s()(),e.DNE(155,hn,4,0,"div",42),e.j41(156,"div",25)(157,"label"),e.EFF(158,"Financement en cours"),e.k0s(),e.j41(159,"select",46)(160,"option",34),e.EFF(161,"Je ne sais pas"),e.k0s(),e.DNE(162,gn,2,2,"option",14),e.k0s()(),e.DNE(163,Cn,4,0,"div",39)(164,Fn,4,0,"div",39),e.j41(165,"div",25)(166,"label"),e.EFF(167,"Opposition a la mutation"),e.k0s(),e.j41(168,"select",47)(169,"option",34),e.EFF(170,"Je ne sais pas"),e.k0s(),e.DNE(171,bn,2,2,"option",14),e.k0s()(),e.j41(172,"div",48)(173,"label"),e.EFF(174,"Commentaire"),e.k0s(),e.nrm(175,"input",49),e.k0s(),e.j41(176,"div",50)(177,"div",51)(178,"ion-button",52),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.dismiss({dismissed:!0}))}),e.EFF(179,"Annuler"),e.k0s()(),e.j41(180,"div",51)(181,"ion-button",53),e.EFF(182),e.k0s()()()()}if(2&i){let o,t,n,r,l,c,a,m,p,h,f,C,w,k,E,N,j,I,S,x;const v=e.XpG();e.Y8G("formGroup",v.carForm),e.R7$(5),e.Y8G("ngIf",(null==(o=v.carForm.get("vehicle_customer"))?null:o.invalid)&&((null==(o=v.carForm.get("vehicle_customer"))?null:o.dirty)||(null==(o=v.carForm.get("vehicle_customer"))?null:o.touched))),e.R7$(7),e.Y8G("ngForOf",v.sites),e.R7$(),e.Y8G("ngIf",(null==(t=v.carForm.get("vehicle_site"))?null:t.invalid)&&((null==(t=v.carForm.get("vehicle_site"))?null:t.dirty)||(null==(t=v.carForm.get("vehicle_site"))?null:t.touched))),e.R7$(5),e.Y8G("ngIf",(null==(n=v.carForm.get("vehicle_date_mec"))?null:n.invalid)&&((null==(n=v.carForm.get("vehicle_date_mec"))?null:n.dirty)||(null==(n=v.carForm.get("vehicle_date_mec"))?null:n.touched))),e.R7$(7),e.Y8G("ngForOf",v.brands),e.R7$(),e.Y8G("ngIf",(null==(r=v.carForm.get("vehicle_brand"))?null:r.invalid)&&((null==(r=v.carForm.get("vehicle_brand"))?null:r.dirty)||(null==(r=v.carForm.get("vehicle_brand"))?null:r.touched))),e.R7$(7),e.Y8G("ngForOf",v.models),e.R7$(),e.Y8G("ngIf",(null==(l=v.carForm.get("vehicle_model"))?null:l.invalid)&&((null==(l=v.carForm.get("vehicle_model"))?null:l.dirty)||(null==(l=v.carForm.get("vehicle_model"))?null:l.touched))),e.R7$(7),e.Y8G("ngForOf",v.fuelTypes),e.R7$(),e.Y8G("ngIf",(null==(c=v.carForm.get("vehicle_fuel"))?null:c.invalid)&&((null==(c=v.carForm.get("vehicle_fuel"))?null:c.dirty)||(null==(c=v.carForm.get("vehicle_fuel"))?null:c.touched))),e.R7$(7),e.Y8G("ngForOf",v.trans),e.R7$(),e.Y8G("ngIf",(null==(a=v.carForm.get("vehicle_type_v"))?null:a.invalid)&&((null==(a=v.carForm.get("vehicle_type_v"))?null:a.dirty)||(null==(a=v.carForm.get("vehicle_type_v"))?null:a.touched))),e.R7$(7),e.Y8G("ngForOf",v.fiscalPower),e.R7$(),e.Y8G("ngIf",(null==(m=v.carForm.get("vehicle_type_v"))?null:m.invalid)&&((null==(m=v.carForm.get("vehicle_type_v"))?null:m.dirty)||(null==(m=v.carForm.get("vehicle_type_v"))?null:m.touched))),e.R7$(7),e.Y8G("ngForOf",v.finition),e.R7$(),e.Y8G("ngIf",(null==(p=v.carForm.get("vehicle_type_v"))?null:p.invalid)&&((null==(p=v.carForm.get("vehicle_type_v"))?null:p.dirty)||(null==(p=v.carForm.get("vehicle_type_v"))?null:p.touched))),e.R7$(3),e.Y8G("ngIf",v.vehicleId),e.R7$(5),e.Y8G("ngIf",(null==(h=v.carForm.get("vehicle_customer_price"))?null:h.invalid)&&((null==(h=v.carForm.get("vehicle_customer_price"))?null:h.dirty)||(null==(h=v.carForm.get("vehicle_customer_price"))?null:h.touched))),e.R7$(5),e.Y8G("ngIf",(null==(f=v.carForm.get("vehicle_km"))?null:f.invalid)&&((null==(f=v.carForm.get("vehicle_km"))?null:f.dirty)||(null==(f=v.carForm.get("vehicle_km"))?null:f.touched))),e.R7$(5),e.Y8G("ngIf",(null==(C=v.carForm.get("vehicle_vin"))?null:C.invalid)&&((null==(C=v.carForm.get("vehicle_vin"))?null:C.dirty)||(null==(C=v.carForm.get("vehicle_vin"))?null:C.touched))),e.R7$(10),e.Y8G("ngForOf",v.registrationChars),e.R7$(),e.Y8G("ngIf","WW"!==(null==(w=v.carForm.get("immat_value_char"))?null:w.value)),e.R7$(),e.Y8G("ngIf",(null==(k=v.carForm.get("vehicle_plate"))?null:k.invalid)&&((null==(k=v.carForm.get("vehicle_plate"))?null:k.dirty)||(null==(k=v.carForm.get("vehicle_plate"))?null:k.touched))),e.R7$(17),e.Y8G("ngForOf",v.prevs),e.R7$(),e.Y8G("ngIf","DED"===(null==(E=v.carForm.get("vehicle_origine"))?null:E.value)||"IMPORTED"===(null==(E=v.carForm.get("vehicle_origine"))?null:E.value)),e.R7$(10),e.Y8G("ngForOf",v.bools),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(),e.Y8G("ngIf",!1===(null==(N=v.carForm.get("vehicle_first_owner"))?null:N.value)),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(),e.Y8G("ngIf",!0===(null==(j=v.carForm.get("vehicle_certifivation_controle_technique"))?null:j.value)),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(),e.Y8G("ngIf",!0===(null==(I=v.carForm.get("vehicle_garantie_en_cours"))?null:I.value)),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(),e.Y8G("ngIf",!0===(null==(S=v.carForm.get("vehicle_gage"))?null:S.value)),e.R7$(),e.Y8G("ngIf",!0===(null==(x=v.carForm.get("vehicle_organisme_finance"))?null:x.value)),e.R7$(7),e.Y8G("ngForOf",v.bools),e.R7$(10),e.Y8G("disabled",!v.carForm.valid),e.R7$(),e.JRh(v.vehicleId?"Modifier":"Enregistrer")}}let z=(()=>{var i;class s{constructor(t,n,r,l,c,a){this.newCarService=t,this.fb=n,this.viewCtrl=r,this.loadingController=l,this.alertController=c,this.gs=a,this.carForm=this.fb.group({vehicle_customer:["",u.k0.required],vehicle_site:["",u.k0.required],vehicle_date_mec:["",u.k0.required],vehicle_brand:["",u.k0.required],vehicle_model:["",u.k0.required],vehicle_fuel:["",u.k0.required],vehicle_type_v:["",u.k0.required],vehicle_pf:["",u.k0.required],vehicle_finition:["",u.k0.required],vehicle_customer_price:["",u.k0.min(1)],vehicle_km:["",[u.k0.min(0),u.k0.max(5e5)]],vehicle_vin:["",u.k0.pattern(U(/^([A-HJ-NPR-Z\d]{3})([A-HJ-NPR-Z\d]{5})([\dX])(([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d]{6}))$/,{wmi:1,vds:2,check:3,vis:4,year:5,plant:6,seq:7}))],immat_value_fc:["",[u.k0.min(100),u.k0.max(99999)]],immat_value_char:"",immat_value_lc:["",[u.k0.min(1),u.k0.max(99)]],vehicle_n_certif_immat:"",vehicle_origine:"",vehicle_date_ded:"",vehicle_first_owner:"",vehicle_date_last_mutation:"",vehicle_certifivation_controle_technique:"",vehicle_date_dernier_controle:"",vehicle_livre_entretien:"",vehicle_livre_entretien_ajour:"",vehicle_garantie_en_cours:"",vehicle_date_fin_garantie:"",vehicle_gage:"",vehicle_organisme_finance:"",vehicle_credit_reste:"",vehicle_opposition_mutation:"",vehicle_type:"",vehicle_plate:"",vehicle_phase:"",vehicle_add_by:"",vehicle_last_edit_by:"",vehicle_status:"",vehicle_date_carte_grise:"",vehicle_provenance:"",vehicle_canal:"",vehicle_tva_recuperable:"",vehicle_comment:"",vehicle_body:"",vehicle_price_new:"",vehicle_data_ref:"",vehicle_destination:"",vehicle_couleur:"",vehicle_additional_option:""}),this.env=R.c.conf,this.brandLogo="",this.registrationChars=["A","B","D","E","H","W","WW"],this.bools=[{front:"Oui",back:!0},{front:"Non",back:!1}],this.prevs=[{prev_id:null,prev_value:"Non d\xe9fini"},{prev_id:2,prev_value:"Reprise sur vente VN"},{prev_id:3,prev_value:"Reprise sur vente VD/VS"},{prev_id:4,prev_value:"Reprise sur vente VO"},{prev_id:5,prev_value:"Achat sec"},{prev_id:6,prev_value:"Cession VD/VS"},{prev_id:7,prev_value:"Lot loueurs"},{prev_id:8,prev_value:"D\xe9p\xf4t-vente"}]}ngOnInit(){var t=this;return(0,d.A)(function*(){t.sites=yield t.newCarService.getSites(),t.vehicleId?t.spinner("Chargement ...").then(function(){var r=(0,d.A)(function*(l){var c,a,m,p,h,f,C,w,k,E,N,j,I,S,x,v,T,P,V,A,G,$,O,F,Y,q,W,M,X,K,Z,Q,ee,ne,te,ie,oe,re;l.present();const g=yield t.newCarService.getVehicleById(t.vehicleId);t.brandLogo=null===(c=g[0])||void 0===c?void 0:c.brand_logo,t.carForm=t.fb.group({vehicle_id:t.vehicleId,vehicle_customer:["",u.k0.required],vehicle_site:[null===(a=g[0])||void 0===a?void 0:a.vehicle_site,u.k0.required],vehicle_date_mec:[null===(m=g[0])||void 0===m?void 0:m.vehicle_date_mec,u.k0.required],vehicle_brand:["",u.k0.required],vehicle_model:["",u.k0.required],vehicle_fuel:["",u.k0.required],vehicle_type_v:["",u.k0.required],vehicle_pf:["",u.k0.required],vehicle_finition:["",u.k0.required],vehicle_customer_price:[null===(p=g[0])||void 0===p?void 0:p.vehicle_customer_price,u.k0.min(1)],vehicle_km:[null===(h=g[0])||void 0===h?void 0:h.vehicle_km,[u.k0.min(0),u.k0.max(5e5)]],vehicle_vin:[null===(f=g[0])||void 0===f?void 0:f.vehicle_vin,u.k0.pattern(U(/^([A-HJ-NPR-Z\d]{3})([A-HJ-NPR-Z\d]{5})([\dX])(([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d]{6}))$/,{wmi:1,vds:2,check:3,vis:4,year:5,plant:6,seq:7}))],immat_value_fc:["",[u.k0.min(100),u.k0.max(99999)]],immat_value_char:"",immat_value_lc:["",[u.k0.min(1),u.k0.max(99)]],vehicle_n_certif_immat:null===(C=g[0])||void 0===C?void 0:C.vehicle_n_certif_immat,vehicle_origine:null===(w=g[0])||void 0===w?void 0:w.vehicle_origine,vehicle_date_ded:null===(k=g[0])||void 0===k?void 0:k.vehicle_date_ded,vehicle_first_owner:null===(E=g[0])||void 0===E?void 0:E.vehicle_first_owner,vehicle_date_last_mutation:null===(N=g[0])||void 0===N?void 0:N.vehicle_date_last_mutation,vehicle_certifivation_controle_technique:null===(j=g[0])||void 0===j?void 0:j.vehicle_certifivation_controle_technique,vehicle_date_dernier_controle:null===(I=g[0])||void 0===I?void 0:I.vehicle_date_dernier_controle,vehicle_livre_entretien:null===(S=g[0])||void 0===S?void 0:S.vehicle_livre_entretien,vehicle_livre_entretien_ajour:null===(x=g[0])||void 0===x?void 0:x.vehicle_livre_entretien_ajour,vehicle_garantie_en_cours:null===(v=g[0])||void 0===v?void 0:v.vehicle_garantie_en_cours,vehicle_date_fin_garantie:null===(T=g[0])||void 0===T?void 0:T.vehicle_date_fin_garantie,vehicle_gage:null===(P=g[0])||void 0===P?void 0:P.vehicle_gage,vehicle_organisme_finance:null===(V=g[0])||void 0===V?void 0:V.vehicle_organisme_finance,vehicle_credit_reste:null===(A=g[0])||void 0===A?void 0:A.vehicle_credit_reste,vehicle_opposition_mutation:null===(G=g[0])||void 0===G?void 0:G.vehicle_opposition_mutation,vehicle_type:null===($=g[0])||void 0===$?void 0:$.vehicle_type,vehicle_plate:null===(O=g[0])||void 0===O?void 0:O.vehicle_plate,vehicle_phase:null===(F=g[0])||void 0===F?void 0:F.vehicle_phase,vehicle_add_by:null===(Y=g[0])||void 0===Y?void 0:Y.vehicle_add_by,vehicle_last_edit_by:null===(q=g[0])||void 0===q?void 0:q.vehicle_last_edit_by,vehicle_status:null===(W=g[0])||void 0===W?void 0:W.vehicle_status,vehicle_date_carte_grise:null===(M=g[0])||void 0===M?void 0:M.vehicle_date_carte_grise,vehicle_provenance:null===(X=g[0])||void 0===X?void 0:X.vehicle_provenance,vehicle_canal:null===(K=g[0])||void 0===K?void 0:K.vehicle_canal,vehicle_tva_recuperable:null===(Z=g[0])||void 0===Z?void 0:Z.vehicle_tva_recuperable,vehicle_comment:null===(Q=g[0])||void 0===Q?void 0:Q.vehicle_comment,vehicle_body:null===(ee=g[0])||void 0===ee?void 0:ee.vehicle_body,vehicle_price_new:null===(ne=g[0])||void 0===ne?void 0:ne.vehicle_price_new,vehicle_data_ref:null===(te=g[0])||void 0===te?void 0:te.vehicle_data_ref,vehicle_destination:null===(ie=g[0])||void 0===ie?void 0:ie.vehicle_destination,vehicle_couleur:null===(oe=g[0])||void 0===oe?void 0:oe.vehicle_couleur,vehicle_additional_option:null===(re=g[0])||void 0===re?void 0:re.vehicle_additional_option}),t.customers=yield t.fileForm(g),l.dismiss()});return function(l){return r.apply(this,arguments)}}()):t.carForm=t.fb.group({vehicle_customer:["",u.k0.required],vehicle_site:["",u.k0.required],vehicle_date_mec:["",u.k0.required],vehicle_brand:["",u.k0.required],vehicle_model:["",u.k0.required],vehicle_fuel:["",u.k0.required],vehicle_type_v:["",u.k0.required],vehicle_pf:["",u.k0.required],vehicle_finition:["",u.k0.required],vehicle_customer_price:["",u.k0.min(1)],vehicle_km:["",[u.k0.min(0),u.k0.max(5e5)]],vehicle_vin:["",u.k0.pattern(U(/^([A-HJ-NPR-Z\d]{3})([A-HJ-NPR-Z\d]{5})([\dX])(([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d])([A-HJ-NPR-Z\d]{6}))$/,{wmi:1,vds:2,check:3,vis:4,year:5,plant:6,seq:7}))],immat_value_fc:["",[u.k0.min(100),u.k0.max(99999)]],immat_value_char:"",immat_value_lc:["",[u.k0.min(1),u.k0.max(99)]],vehicle_n_certif_immat:"",vehicle_origine:"",vehicle_date_ded:"",vehicle_first_owner:"",vehicle_date_last_mutation:"",vehicle_certifivation_controle_technique:"",vehicle_date_dernier_controle:"",vehicle_livre_entretien:"",vehicle_livre_entretien_ajour:"",vehicle_garantie_en_cours:"",vehicle_date_fin_garantie:"",vehicle_gage:"",vehicle_organisme_finance:"",vehicle_credit_reste:"",vehicle_opposition_mutation:"",vehicle_type:"",vehicle_plate:"",vehicle_phase:"",vehicle_add_by:"",vehicle_last_edit_by:"",vehicle_status:"",vehicle_date_carte_grise:"",vehicle_provenance:"",vehicle_canal:"",vehicle_tva_recuperable:"",vehicle_comment:"",vehicle_body:"",vehicle_price_new:"",vehicle_data_ref:"",vehicle_destination:"",vehicle_couleur:"",vehicle_additional_option:""})})()}openModal(){var t=this;return(0,d.A)(function*(){var n;if(null===(n=t.env)||void 0===n||null===(n=n.vehicleOperations)||void 0===n||!n.customerList||!t.gs.checkPermission("customer"))return;const r=yield t.viewCtrl.create({component:Ve});return yield r.present().then((0,d.A)(function*(){const{data:l}=yield r.onWillDismiss();if(l&&!l.dismissed){var c,a;t.owner=yield t.newCarService.getOwnerById(l.customerId),console.log(t.owner);const m=(null===(c=t.owner[0])||void 0===c?void 0:c.customer_f_name)+" "+(null===(a=t.owner[0])||void 0===a?void 0:a.customer_l_name);t.carForm.controls.vehicle_customer.setValue(m),console.log(t.carForm)}}))})()}dismiss(t){this.viewCtrl.dismiss(t)}spinner(t){var n=this;return(0,d.A)(function*(){return yield n.loadingController.create({cssClass:"my-custom-class",message:t})})()}getItemsAsync(){return(0,d.A)(function*(){})()}fileForm(t){var n=this;return(0,d.A)(function*(){var r,l,c,a;n.owner=yield n.newCarService.getOwnerById(null===(r=t[0])||void 0===r?void 0:r.customer_id);const m=(null===(l=n.owner[0])||void 0===l?void 0:l.customer_f_name)+" "+(null===(c=n.owner[0])||void 0===c?void 0:c.customer_l_name);if(n.carForm.controls.vehicle_customer.setValue(m),null!==(a=t[0])&&void 0!==a&&a.vehicle_date_mec){var p,h,f,C,w,k,E,N,j,I,S,x,v,T,P,V,A,G,$,O,F,Y;n.subDate=null===(p=t[0])||void 0===p?void 0:p.vehicle_date_mec.substring(0,(null===(h=t[0])||void 0===h?void 0:h.vehicle_date_mec.length)-3),n.brands=yield n.newCarService.getBrandsByDate(n.subDate);const W=n.brands.findIndex(M=>{var X;return M.brand_name===(null===(X=t[0])||void 0===X?void 0:X.vehicle_brand)});if(n.carForm.controls.vehicle_brand.setValue(n.brands[W]),n.models=yield n.newCarService.getModels(null===(f=t[0])||void 0===f?void 0:f.vehicle_brand,n.subDate),n.carForm.controls.vehicle_model.setValue(null===(C=t[0])||void 0===C?void 0:C.vehicle_model),n.fuelTypes=yield n.newCarService.getFuelTypes(null===(w=t[0])||void 0===w?void 0:w.vehicle_brand,n.subDate,null===(k=t[0])||void 0===k?void 0:k.vehicle_model),n.carForm.controls.vehicle_fuel.setValue(null===(E=t[0])||void 0===E?void 0:E.vehicle_fuel),n.trans=yield n.newCarService.getTransTypes(null===(N=t[0])||void 0===N?void 0:N.vehicle_brand,n.subDate,null===(j=t[0])||void 0===j?void 0:j.vehicle_model,null===(I=t[0])||void 0===I?void 0:I.vehicle_fuel),n.carForm.controls.vehicle_type_v.setValue(null===(S=t[0])||void 0===S?void 0:S.vehicle_type_v),n.fiscalPower=yield n.newCarService.getFiscalPower(null===(x=t[0])||void 0===x?void 0:x.vehicle_brand,n.subDate,null===(v=t[0])||void 0===v?void 0:v.vehicle_model,null===(T=t[0])||void 0===T?void 0:T.vehicle_fuel,null===(P=t[0])||void 0===P?void 0:P.vehicle_type_v),n.carForm.controls.vehicle_pf.setValue(null===(V=t[0])||void 0===V?void 0:V.vehicle_pf),n.finition=yield n.newCarService.getFinition(null===(A=t[0])||void 0===A?void 0:A.vehicle_brand,n.subDate,null===(G=t[0])||void 0===G?void 0:G.vehicle_model,null===($=t[0])||void 0===$?void 0:$.vehicle_fuel,null===(O=t[0])||void 0===O?void 0:O.vehicle_type_v,null===(F=t[0])||void 0===F?void 0:F.vehicle_pf),n.carForm.controls.vehicle_finition.setValue(null===(Y=t[0])||void 0===Y?void 0:Y.vehicle_finition),t[0].vehicle_plate){var q;const M=null===(q=t[0])||void 0===q?void 0:q.vehicle_plate.split("-");n.carForm.controls.immat_value_fc.setValue(M[0]),n.carForm.controls.immat_value_char.setValue(M[1]),n.carForm.controls.immat_value_lc.setValue(M[2])}}})()}onDateChange(t){var n=this;return(0,d.A)(function*(){""!==t&&(n.brands=void 0,n.carForm.controls.vehicle_brand.setValue(void 0),n.models=void 0,n.carForm.controls.vehicle_model.setValue(void 0),n.fuelTypes=void 0,n.carForm.controls.vehicle_fuel.setValue(void 0),n.trans=void 0,n.carForm.controls.vehicle_type_v.setValue(void 0),n.fiscalPower=void 0,n.carForm.controls.vehicle_pf.setValue(void 0),n.finition=void 0,n.carForm.controls.vehicle_finition.setValue(void 0),n.subDate=t.substring(0,t.length-3),n.brands=yield n.newCarService.getBrandsByDate(n.subDate))})()}onBrandChange(t){var n=this;return(0,d.A)(function*(){""!==t&&""!==n.subDate&&(n.models=void 0,n.carForm.controls.vehicle_model.setValue(void 0),n.fuelTypes=void 0,n.carForm.controls.vehicle_fuel.setValue(void 0),n.trans=void 0,n.carForm.controls.vehicle_type_v.setValue(void 0),n.fiscalPower=void 0,n.carForm.controls.vehicle_pf.setValue(void 0),n.finition=void 0,n.carForm.controls.vehicle_finition.setValue(void 0),n.brandLogo=t.brand_logo,n.models=yield n.newCarService.getModels(t.brand_name,n.subDate))})()}onModelChange(t,n){var r=this;return(0,d.A)(function*(){""!==n&&""!==r.subDate&&""!==t&&(r.fuelTypes=void 0,r.carForm.controls.vehicle_fuel.setValue(void 0),r.trans=void 0,r.carForm.controls.vehicle_type_v.setValue(void 0),r.fiscalPower=void 0,r.carForm.controls.vehicle_pf.setValue(void 0),r.finition=void 0,r.carForm.controls.vehicle_finition.setValue(void 0),r.fuelTypes=yield r.newCarService.getFuelTypes(t,r.subDate,n))})()}onFuelChange(t,n,r){var l=this;return(0,d.A)(function*(){l.trans=void 0,l.carForm.controls.vehicle_type_v.setValue(void 0),l.fiscalPower=void 0,l.carForm.controls.vehicle_pf.setValue(void 0),l.finition=void 0,l.carForm.controls.vehicle_finition.setValue(void 0),""!==n&&""!==l.subDate&&""!==t&&""!==r&&(l.trans=yield l.newCarService.getTransTypes(t,l.subDate,n,r))})()}onTransChange(t,n,r,l){var c=this;return(0,d.A)(function*(){""!==n&&""!==c.subDate&&""!==t&&""!==r&&""!==l&&(c.fiscalPower=void 0,c.carForm.controls.vehicle_pf.setValue(void 0),c.finition=void 0,c.carForm.controls.vehicle_finition.setValue(void 0),c.fiscalPower=yield c.newCarService.getFiscalPower(t,c.subDate,n,r,l))})()}onFiscalChange(t,n,r,l,c){var a=this;return(0,d.A)(function*(){""!==n&&""!==a.subDate&&""!==t&&""!==r&&""!==l&&""!==c&&(a.finition=void 0,a.carForm.controls.vehicle_finition.setValue(void 0),a.finition=yield a.newCarService.getFinition(t,a.subDate,n,r,l,c))})()}onVehicleSubmit(t){var n=this;return(0,d.A)(function*(){var r;if(""!==(null===(r=n.carForm.get("immat_value_fc"))||void 0===r?void 0:r.value)){var l,c,a;const p=(null===(l=n.carForm.get("immat_value_fc"))||void 0===l?void 0:l.value)+"-"+(null===(c=n.carForm.get("immat_value_char"))||void 0===c?void 0:c.value)+"-"+(null===(a=n.carForm.get("immat_value_lc"))||void 0===a?void 0:a.value);n.carForm.controls.vehicle_plate.setValue(p)}n.owner&&n.carForm.controls.vehicle_customer.setValue(n.owner[0].customer_id);const m=n.carForm.get("vehicle_brand");n.carForm.controls.vehicle_brand.setValue(null==m?void 0:m.value.brand_name),t.valid&&n.vehicleId?n.spinner("Modification ...").then(function(){var h=(0,d.A)(function*(f){f.present(),yield n.newCarService.editCar(t.value),f.dismiss()});return function(f){return h.apply(this,arguments)}}()).finally(()=>{if("success"!==n.newCarService.responseEditing.result){const h=n.brands.findIndex(f=>f.brand_name===(null==m?void 0:m.value));n.carForm.controls.vehicle_brand.setValue(n.brands[h]),n.presentAlert(n.newCarService.responseEditing.message)}else n.dismiss({edited:!0})}):t.valid&&(n.carForm.controls.vehicle_status.setValue({isDraft:!0}),n.spinner("Envoie ...").then(function(){var h=(0,d.A)(function*(f){f.present(),yield n.newCarService.postNewCar(t.value),f.dismiss()});return function(f){return h.apply(this,arguments)}}()).finally(()=>{if("success"!==n.newCarService.responseCreation.result){const h=n.brands.findIndex(f=>f.brand_name===(null==m?void 0:m.value));n.carForm.controls.vehicle_brand.setValue(n.brands[h]),n.presentAlert(n.newCarService.responseCreation.message)}else n.dismiss({created:!0})}))})()}presentAlert(t){var n=this;return(0,d.A)(function*(){yield(yield n.alertController.create({header:"Alert",message:t,buttons:["OK"]})).present()})()}getFinitionDataRef(){var t;this.newCarService.getFinitionData(null===(t=this.carForm.get("vehicle_finition"))||void 0===t?void 0:t.value).then(n=>{var r,l,c,a,m,p,h,f;"success"===(null==n?void 0:n.result)&&(null==n||null===(r=n.data)||void 0===r?void 0:r.length)>0&&(null===(l=this.carForm.get("vehicle_data_ref"))||void 0===l||l.setValue(null==n?void 0:n.data[0]),null===(c=this.carForm.get("vehicle_type"))||void 0===c||c.setValue(null==n||null===(a=n.data[0])||void 0===a?void 0:a.car_type),null===(m=this.carForm.get("vehicle_body"))||void 0===m||m.setValue(null==n||null===(p=n.data[0])||void 0===p?void 0:p.body),null===(h=this.carForm.get("vehicle_price_new"))||void 0===h||h.setValue(null==n||null===(f=n.data[0])||void 0===f?void 0:f.price))})}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(H),e.rXU(u.ok),e.rXU(_.W3),e.rXU(_.Xi),e.rXU(_.hG),e.rXU(B.O))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-new-car"]],inputs:{vehicleId:"vehicleId"},decls:8,vars:2,consts:[["color","dark"],["name","arrow-back","slot","start",1,"ms-3",2,"width","24px","height","24px",3,"click"],[1,""],[1,"row","justify-content-center","px-0","py-2","mx-1",2,"overflow-y","auto"],["class","col-4 d-flex justify-content-center",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"col-4","d-flex","justify-content-center"],[3,"src"],[3,"ngSubmit","formGroup"],[1,"col-12","form-group"],["formControlName","vehicle_customer","value","--","required","","readonly","",1,"form-control",3,"click"],["class","text-danger",4,"ngIf"],["formControlName","vehicle_site","required","",1,"form-control"],["value","","disabled",""],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","vehicle_date_mec","type","date","aria-label","Date input with dropdown button","required","",1,"form-control",3,"change"],["formControlName","vehicle_brand","required","",1,"form-control",3,"change"],["formControlName","vehicle_model","required","",1,"form-control",3,"change"],["formControlName","vehicle_fuel","aria-label","Selection","required","",1,"form-control",3,"change"],["formControlName","vehicle_type_v","aria-label","Selection","required","",1,"form-control",3,"change"],["formControlName","vehicle_pf","aria-label","Selection","required","",1,"form-control",3,"change"],["formControlName","vehicle_finition","aria-label","Selection","required","",1,"form-control",3,"change"],[1,"w-100","my-4","h5","text-center"],["class","col-12 form-group",4,"ngIf"],["formControlName","vehicle_customer_price","type","number","aria-label","Number input",1,"form-control"],[1,"col-12","mt-3","form-group"],["formControlName","vehicle_km","type","number","aria-label","Number input",1,"form-control"],["formControlName","vehicle_vin","type","text","aria-label","Alpha-Num input","pattern","",1,"form-control"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["type","number","aria-label","Text input with dropdown button","formControlName","immat_value_fc",1,"form-control","rounded-0","px-0",2,"border-radius","5px 0 0 5px !important"],["formControlName","immat_value_char",1,"form-control","rounded-0","w-25"],["formControlName","immat_value_lc","type","number","class","form-control rounded-0","style","border-radius:0 5px 5px 0 !important;","aria-label","Text input with dropdown button",4,"ngIf"],["formControlName","vehicle_origine",1,"form-control"],["value",""],["value","DED"],["value","IMPORTED"],["value","WWM"],["formControlName","vehicle_provenance",1,"form-control"],["class","mt-3 col-12 form-group",4,"ngIf"],["formControlName","vehicle_first_owner",1,"form-control"],["formControlName","vehicle_tva_recuperable",1,"form-control"],["class","col-12 mt-3 form-group",4,"ngIf"],["formControlName","vehicle_certifivation_controle_technique",1,"form-control"],["formControlName","vehicle_livre_entretien",1,"form-control"],["formControlName","vehicle_garantie_en_cours",1,"form-control"],["formControlName","vehicle_gage",1,"form-control"],["formControlName","vehicle_opposition_mutation",1,"form-control"],[1,"mt-3","col-12","form-group"],["formControlName","vehicle_comment","type","text","aria-label","Text input with dropdown button",1,"form-control"],[1,"row","mx-auto"],[1,"col-6"],["expand","block","color","danger",3,"click"],["type","submit","expand","block","color","dark",3,"disabled"],[1,"text-danger"],[3,"ngValue"],["formControlName","vehicle_couleur","type","text","aria-label","Number input",1,"form-control"],["formControlName","immat_value_lc","type","number","aria-label","Text input with dropdown button",1,"form-control","rounded-0",2,"border-radius","0 5px 5px 0 !important"],["formControlName","vehicle_date_ded","type","date","aria-label","Date input with dropdown button",1,"form-control"],["formControlName","vehicle_date_last_mutation","type","date","aria-label","Date input with dropdown button",1,"form-control"],["formControlName","vehicle_date_dernier_controle","type","date","aria-label","Date input with dropdown button",1,"form-control"],["formControlName","vehicle_date_fin_garantie","type","date","aria-label","Date input with dropdown button",1,"form-control"],["formControlName","vehicle_organisme_finance","type","text","aria-label","Text input with dropdown button",1,"form-control"],["formControlName","vehicle_credit_reste","type","number","aria-label","Text input with dropdown button",1,"form-control"]],template:function(t,n){1&t&&(e.j41(0,"ion-toolbar",0)(1,"ion-icon",1),e.bIt("click",function(){return n.dismiss({dismissed:!0})}),e.k0s(),e.j41(2,"ion-title",2),e.EFF(3," Informations V\xe9hicule "),e.k0s()(),e.j41(4,"ion-content")(5,"div",3),e.DNE(6,Ae,2,1,"div",4)(7,kn,183,40,"form",5),e.k0s()()),2&t&&(e.R7$(6),e.Y8G("ngIf",""!==n.brandLogo),e.R7$(),e.Y8G("ngIf",n.carForm))},dependencies:[y.Sq,y.bT,u.qT,u.xH,u.y7,u.me,u.Q0,u.wz,u.BC,u.cb,u.YS,u.R_,_.Jm,_.W9,_.iq,_.KW,_.BC,_.ai,u.j4,u.JD],styles:[".ng-valid[required][_ngcontent-%COMP%], .ng-valid.required[_ngcontent-%COMP%]{border-left:5px solid #42A948}.ng-invalid[_ngcontent-%COMP%]:not(form){border-left:5px solid #a94442}.alert[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#fed3d3;color:#820000;padding:1rem;margin-bottom:1rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem}select[_ngcontent-%COMP%]{width:100%;padding:.5rem}"]}),s})();function yn(i,s){if(1&i&&(e.j41(0,"div",6),e.nrm(1,"ion-img",7),e.k0s()),2&i){const o=e.XpG();e.R7$(),e.Y8G("src",null==o.vehicle?null:o.vehicle.brand_logo)}}function En(i,s){if(1&i&&(e.j41(0,"option",17),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.site_id),e.R7$(),e.SpI(" ",o.site_name," ")}}function wn(i,s){if(1&i&&(e.j41(0,"option",17),e.EFF(1),e.k0s()),2&i){const o=s.$implicit;e.Y8G("ngValue",o.user_id),e.R7$(),e.SpI(" ",o.title," ")}}function Nn(i,s){if(1&i){const o=e.RV6();e.j41(0,"form",8),e.bIt("ngSubmit",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onOpSubmit(n.opForm))}),e.j41(1,"ion-row")(2,"ion-col",3)(3,"div",9)(4,"label"),e.EFF(5,"Site"),e.k0s(),e.j41(6,"select",10),e.bIt("change",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.onSiteChange(n.opForm.value.site_id))}),e.j41(7,"option",11),e.EFF(8,"--"),e.k0s(),e.DNE(9,En,2,2,"option",12),e.k0s()()()(),e.j41(10,"ion-row")(11,"ion-col",3)(12,"div",9)(13,"label"),e.EFF(14,"Expert"),e.k0s(),e.j41(15,"select",13)(16,"option",11),e.EFF(17,"--"),e.k0s(),e.DNE(18,wn,2,2,"option",12),e.k0s()()()(),e.j41(19,"ion-row")(20,"ion-col",3)(21,"div",9)(22,"label"),e.EFF(23,"Commentaire"),e.k0s(),e.nrm(24,"textarea",14),e.k0s()()(),e.j41(25,"ion-row")(26,"ion-col",3)(27,"ion-button",15),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.dismiss({dismissed:!0}))}),e.EFF(28,"Annuler"),e.k0s()(),e.j41(29,"ion-col",3)(30,"ion-button",16),e.EFF(31,"Expertise"),e.k0s()()()()}if(2&i){const o=e.XpG();e.Y8G("formGroup",o.opForm),e.R7$(9),e.Y8G("ngForOf",o.sites),e.R7$(9),e.Y8G("ngForOf",o.experts),e.R7$(12),e.Y8G("disabled",!o.opForm.valid)}}let ue=(()=>{var i;class s{constructor(t,n,r,l,c){this.modalController=t,this.fb=n,this.newCarService=r,this.loadingController=l,this.alertController=c,this.vehicleId="",this.logo=""}ngOnInit(){var t=this;return(0,d.A)(function*(){t.spinner("Chargement ...").then(function(){var r=(0,d.A)(function*(l){var c,a,m;l.present(),t.vehicle=yield t.newCarService.getVehicleById(t.vehicleId),t.sites=yield t.newCarService.getSites(),t.vehicle=t.vehicle[0],t.logo=t.vehicle.brand_logo,t.experts=yield t.newCarService.getExpertsBySiteId(null===(c=t.vehicle)||void 0===c?void 0:c.vehicle_site),t.opForm=t.fb.group({site_id:[null===(a=t.vehicle)||void 0===a?void 0:a.vehicle_site,u.k0.required],operations_dt_operation_key:"EXPERTISE",operations_dt_data:[[]],operations_dt_vehicle:null===(m=t.vehicle)||void 0===m?void 0:m.vehicle_id,operations_dt_comment:"",operations_dt_with:[null],operations_dt_comment_audio:"",operations_dt_operator:[null,u.k0.required]}),l.dismiss()});return function(l){return r.apply(this,arguments)}}())})()}spinner(t){var n=this;return(0,d.A)(function*(){return yield n.loadingController.create({cssClass:"my-custom-class",message:t})})()}dismiss(t){var n=this;return(0,d.A)(function*(){yield n.modalController.dismiss(t)})()}onSiteChange(t){var n=this;return(0,d.A)(function*(){n.experts=yield n.newCarService.getExpertsBySiteId(t)})()}onOpSubmit(t){var n=this;return(0,d.A)(function*(){n.spinner("Envoie ...").then(function(){var l=(0,d.A)(function*(c){c.present(),yield n.newCarService.addOp(t.value),c.dismiss()});return function(c){return l.apply(this,arguments)}}()).finally(()=>{"success"!==n.newCarService.responseOp.result?n.presentAlert(n.newCarService.responseOp.message):n.dismiss({createdOp:!0})})})()}presentAlert(t){var n=this;return(0,d.A)(function*(){yield(yield n.alertController.create({header:"Alert",message:t,buttons:["OK"]})).present()})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(_.W3),e.rXU(u.ok),e.rXU(H),e.rXU(_.Xi),e.rXU(_.hG))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-new-expertise"]],inputs:{vehicleId:"vehicleId"},decls:15,vars:5,consts:[["color","dark"],["name","arrow-back","slot","start",1,"ms-3",2,"width","24px","height","24px",3,"click"],[1,"ion-padding"],[1,"text-center"],["class","d-flex justify-content-center",4,"ngIf"],[3,"formGroup","ngSubmit",4,"ngIf"],[1,"d-flex","justify-content-center"],[2,"width","80px","height","80px",3,"src"],[3,"ngSubmit","formGroup"],[1,"form-group"],["formControlName","site_id","required","",1,"form-control",3,"change"],["value","","disabled",""],[3,"ngValue",4,"ngFor","ngForOf"],["formControlName","operations_dt_operator","required","",1,"form-control"],["formControlName","operations_dt_comment","aria-label","Text input",1,"form-control"],["color","danger",3,"click"],["type","submit","color","dark",3,"disabled"],[3,"ngValue"]],template:function(t,n){1&t&&(e.j41(0,"ion-toolbar",0)(1,"ion-icon",1),e.bIt("click",function(){return n.dismiss({dismissed:!0})}),e.k0s(),e.j41(2,"ion-title"),e.EFF(3," D\xe9marrer Expertise "),e.k0s()(),e.j41(4,"ion-content",2)(5,"ion-grid")(6,"ion-row")(7,"ion-col",3),e.DNE(8,yn,2,1,"div",4),e.j41(9,"p"),e.EFF(10),e.k0s(),e.j41(11,"p")(12,"strong"),e.EFF(13),e.k0s()()()(),e.DNE(14,Nn,32,4,"form",5),e.k0s()()),2&t&&(e.R7$(8),e.Y8G("ngIf",""!==n.logo),e.R7$(2),e.Lme("",null==n.vehicle?null:n.vehicle.vehicle_model," - ",null==n.vehicle?null:n.vehicle.vehicle_brand,""),e.R7$(3),e.JRh(null==n.vehicle?null:n.vehicle.vehicle_finition),e.R7$(),e.Y8G("ngIf",n.opForm))},dependencies:[y.Sq,y.bT,u.qT,u.xH,u.y7,u.me,u.wz,u.BC,u.cb,u.YS,_.Jm,_.hU,_.W9,_.lO,_.iq,_.KW,_.ln,_.BC,_.ai,u.j4,u.JD]}),s})();function jn(i,s){if(1&i&&(e.j41(0,"div",11)(1,"div",12),e.nrm(2,"ion-icon",16),e.EFF(3),e.nI1(4,"number"),e.j41(5,"small"),e.EFF(6," km"),e.k0s()(),e.j41(7,"div",12),e.nrm(8,"ion-icon",17),e.EFF(9),e.nI1(10,"date"),e.k0s()()),2&i){const o=e.XpG();e.R7$(3),e.Lme(" ",e.bMT(4,3,null==o.vehicle?null:o.vehicle.vehicle_km)," ",null!=o.vehicle&&o.vehicle.vehicle_km?"":"-"," "),e.R7$(6),e.SpI(" ",e.bMT(10,5,null==o.vehicle?null:o.vehicle.vehicle_date_mec)," ")}}let In=(()=>{var i;class s{constructor(t,n,r){this.actionSheetController=t,this.modalCtrl=n,this.gs=r,this.env=null==R.c?void 0:R.c.conf}ngOnInit(){console.log("s")}presentActionSheet(t){var n=this;return(0,d.A)(function*(){var r,l;const c=[];if(null!==(r=n.env)&&void 0!==r&&null!==(r=r.vehicleOperations)&&void 0!==r&&r.editVehicle&&n.gs.checkPermission("o_edit_product")&&c.push({text:"Modifier",icon:"pencil",handler:(h=(0,d.A)(function*(){var f;if(null!==(f=n.env)&&void 0!==f&&null!==(f=f.vehicleOperations)&&void 0!==f&&f.editVehicle&&n.gs.checkPermission("o_edit_product"))return yield(yield n.modalCtrl.create({component:z,componentProps:{vehicleId:t}})).present();n.gs.toastMessage("Vous n'avez pas la permission")}),function(){return h.apply(this,arguments)})}),null!==(l=n.env)&&void 0!==l&&null!==(l=l.vehicleOperations)&&void 0!==l&&l.addExpertise&&n.gs.checkPermission("expertise")&&c.push({text:"Planfier une expertise",icon:"search",handler:function(){var h=(0,d.A)(function*(){var f;if(null!==(f=n.env)&&void 0!==f&&null!==(f=f.vehicleOperations)&&void 0!==f&&f.addExpertise&&n.gs.checkPermission("expertise"))return yield(yield n.modalCtrl.create({component:ue,componentProps:{vehicleId:t}})).present();n.gs.toastMessage("Vous n'avez pas la permission")});return function(){return h.apply(this,arguments)}}()}),0===c.length)return;var h;const a=yield n.actionSheetController.create({buttons:c});yield a.present();const{role:m,data:p}=yield a.onDidDismiss();console.log("onDidDismiss resolved with role and data",m,p)})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(_.GD),e.rXU(_.W3),e.rXU(B.O))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-vehicle-card"]],inputs:{vehicle:"vehicle"},decls:29,vars:14,consts:[[1,"row","mb-2",3,"click"],[1,"col-12"],[1,"card","border-0","shadow"],[1,"card-body","p-2","pb-0"],[1,"d-flex","justify-content-start"],[1,"d-flex","flex-column","p-2","w-100"],[1,"m-0","p-0","font-10","text-muted",2,"position","absolute","top","0","right","0"],[1,"text-truncate","mb-1"],[1,"img-fluid","mr-2",2,"width","28px","min-width","28px","max-width","28px",3,"src"],[1,"text-dark","text-truncate","mb-0","font-15"],["class","text-dark d-flex justify-content-between w-100 font-15",4,"ngIf"],[1,"text-dark","d-flex","justify-content-between","w-100","font-15"],[1,"mb-0","d-flex","align-items-center"],["name","people",1,"mr-1"],["name","business",1,"mr-1"],[1,"d-flex","justify-content-between","text-black-50","font-13"],["name","speedometer",1,"mr-1"],["name","calendar",1,"mr-1"]],template:function(t,n){1&t&&(e.j41(0,"div",0),e.bIt("click",function(){return n.presentActionSheet(null==n.vehicle?null:n.vehicle.vehicle_id)}),e.j41(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5)(6,"p",6),e.EFF(7),e.k0s(),e.j41(8,"p",7),e.nrm(9,"img",8),e.j41(10,"strong"),e.EFF(11),e.k0s(),e.EFF(12),e.k0s(),e.j41(13,"p",9),e.EFF(14),e.k0s(),e.DNE(15,jn,11,7,"div",10),e.j41(16,"div",11)(17,"div",12),e.nrm(18,"ion-icon",13),e.EFF(19),e.k0s(),e.j41(20,"div",12),e.nrm(21,"ion-icon",14),e.EFF(22),e.k0s()()()(),e.j41(23,"div",15)(24,"div"),e.EFF(25),e.k0s(),e.j41(26,"div"),e.EFF(27),e.nI1(28,"date"),e.k0s()()()()()()),2&t&&(e.R7$(7),e.SpI("#",null==n.vehicle?null:n.vehicle.vehicle_ref,""),e.R7$(2),e.Y8G("src",null==n.vehicle?null:n.vehicle.brand_logo,e.B4B),e.R7$(2),e.JRh(null==n.vehicle?null:n.vehicle.vehicle_brand),e.R7$(),e.SpI(" ",null==n.vehicle?null:n.vehicle.vehicle_model," "),e.R7$(2),e.SpI(" ",null==n.vehicle?null:n.vehicle.vehicle_finition," "),e.R7$(),e.Y8G("ngIf",!1),e.R7$(4),e.Lme(" ",null==n.vehicle?null:n.vehicle.customer_f_name," ",null==n.vehicle?null:n.vehicle.customer_l_name," "),e.R7$(3),e.SpI(" ",null==n.vehicle?null:n.vehicle.site_name," "),e.R7$(3),e.Lme(" ",null==n.vehicle?null:n.vehicle.user_f_name," ",null==n.vehicle?null:n.vehicle.user_l_name," "),e.R7$(2),e.SpI(" ",e.bMT(28,12,null==n.vehicle?null:n.vehicle.vehicle_date_create)," "))},dependencies:[y.bT,_.iq,y.QX,y.vh]}),s})();function Sn(i,s){if(1&i){const o=e.RV6();e.j41(0,"ion-icon",13),e.bIt("click",function(){e.eBV(o);const n=e.XpG();return e.Njj(n.openModal())}),e.k0s()}}function xn(i,s){if(1&i&&(e.j41(0,"ion-grid")(1,"ion-row")(2,"ion-col",14),e.nrm(3,"img",15),e.j41(4,"ion-text",16),e.EFF(5,"Aucune donn\xe9e disponible"),e.k0s()()()()),2&i){const o=e.XpG();e.R7$(4),e.Y8G("color",o.color.sec)}}function Dn(i,s){1&i&&e.nrm(0,"app-vehicle-card",17),2&i&&e.Y8G("vehicle",s.$implicit)}function Rn(i,s){if(1&i){const o=e.RV6();e.j41(0,"ion-card",18)(1,"div",6)(2,"div",19)(3,"ion-item",20)(4,"ion-label"),e.EFF(5),e.k0s(),e.j41(6,"ion-button",21),e.bIt("click",function(n){e.eBV(o);const r=e.XpG();return e.Njj(r.openOpModal(n))}),e.EFF(7," Expert "),e.k0s(),e.j41(8,"ion-button",22),e.bIt("click",function(n){e.eBV(o);const r=e.XpG();return e.Njj(r.openEditModal(n))}),e.EFF(9,"Edit "),e.k0s()(),e.j41(10,"div",23)(11,"div",24),e.nrm(12,"ion-img",25),e.k0s(),e.j41(13,"div",26)(14,"div",6)(15,"div",27),e.EFF(16),e.k0s(),e.j41(17,"div",20),e.EFF(18),e.k0s(),e.j41(19,"div",20),e.EFF(20),e.k0s(),e.j41(21,"div",20),e.EFF(22),e.k0s()()()()()()()}if(2&i){const o=s.$implicit;e.R7$(5),e.Lme("",null==o?null:o.vehicle_model," - ",null==o?null:o.vehicle_brand,""),e.R7$(),e.Y8G("id",null==o?null:o.vehicle_id),e.R7$(2),e.Y8G("id",null==o?null:o.vehicle_id),e.R7$(4),e.Y8G("src",null==o?null:o.brand_logo),e.R7$(4),e.SpI(" ",null==o?null:o.vehicle_finition," "),e.R7$(2),e.SpI(" Kilom\xe9trage ",null==o?null:o.vehicle_km," KM "),e.R7$(2),e.SpI(" Date MEC ",o.vehicle_date_mec," "),e.R7$(2),e.E5c(" ",o.operations_name," pour ",o.user_f_name," ",o.user_l_name," ")}}let Tn=(()=>{var i;class s{constructor(t,n,r,l){this.newCarService=t,this.loadingController=n,this.modalCtrl=r,this.gs=l,this.color=b.Y.COLORS,this.env=R.c.conf,this.keyWord="",this.index=1}ngOnInit(){var t=this;return(0,d.A)(function*(){yield t.getItemsAsync()})()}openModal(){var t=this;return(0,d.A)(function*(){var n;if(null===(n=t.env)||void 0===n||null===(n=n.vehicleOperations)||void 0===n||!n.addVehicle||!t.gs.checkPermission("o_add_product"))return void t.gs.toastMessage("Vous n'avez pas la permission");const r=yield t.modalCtrl.create({component:z});return yield r.present().then((0,d.A)(function*(){const{data:l}=yield r.onWillDismiss();l?console.log(l):l&&l.created&&(yield t.getItemsAsync())}))})()}openEditModal(t){var n=this;return(0,d.A)(function*(){const r=t.target.id;return yield(yield n.modalCtrl.create({component:z,componentProps:{vehicleId:r}})).present()})()}openOpModal(t){var n=this;return(0,d.A)(function*(){return yield(yield n.modalCtrl.create({component:ue,componentProps:{vehicleId:t.target.id}})).present()})()}spinner(t){var n=this;return(0,d.A)(function*(){return yield n.loadingController.create({cssClass:"my-custom-class",message:t})})()}getItemsAsync(){var t=this;return(0,d.A)(function*(){t.spinner("Chargement ...").then(function(){var r=(0,d.A)(function*(l){l.present(),t.vehicles=yield t.newCarService.getVehicles(),l.dismiss()});return function(l){return r.apply(this,arguments)}}())})()}loadData(t){var n=this;return(0,d.A)(function*(){setTimeout((0,d.A)(function*(){if(n.index+=1,n.keyWord){const r=yield n.newCarService.getVehicles(n.keyWord,n.index);n.vehicles=[...n.vehicles,...r]}else{const r=yield n.newCarService.getVehicles("",n.index);n.vehicles=[...n.vehicles,...r]}t.target.complete(),1e3===n.vehicles.length&&(t.target.disabled=!0)}),500)})()}onClearSearch(){var t=this;return(0,d.A)(function*(){t.keyWord="",t.index=1,t.vehicles=yield t.newCarService.getVehicles()})()}handleSearch(t){var n=this;return(0,d.A)(function*(){n.keyWord=t.target.value,n.index=1,n.vehicles=yield n.newCarService.getVehicles(n.keyWord)})()}handleRefresh(t){var n=this;return(0,d.A)(function*(){n.index=1,n.vehicles=yield n.newCarService.getVehicles(n.keyWord),t.target.complete()})()}}return(i=s).\u0275fac=function(t){return new(t||i)(e.rXU(H),e.rXU(_.Xi),e.rXU(_.W3),e.rXU(B.O))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-cars"]],viewQuery:function(t,n){if(1&t&&e.GBs(_.Ax,5),2&t){let r;e.mGM(r=e.lsd())&&(n.infiniteScroll=r.first)}},decls:17,vars:4,consts:[[1,"p-2","d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["class","add-icon mr-0","name","add",3,"click",4,"ngIf"],["type","text","debounce","500","placeholder","Search",3,"ionClear","keyup.enter"],[1,"ion-padding"],["slot","fixed",3,"ionRefresh"],[1,"row"],[4,"ngIf"],[1,"w-100","px-2"],[3,"vehicle",4,"ngFor","ngForOf"],["threshold","100px",3,"ionInfinite"],["loadingSpinner","bubbles","loadingText","Loading more data..."],["class","d-none",4,"ngFor","ngForOf"],["name","add",1,"add-icon","mr-0",3,"click"],[1,"text-center"],["src","../../assets/empty.svg","alt","char",1,"char-empty"],[3,"color"],[3,"vehicle"],[1,"d-none"],[1,"col-11"],[1,"col-12"],["fill","outline","slot","end",3,"click","id"],["fill","outline","slot","end","color","danger",3,"click","id"],[1,"row","py-2"],[1,"col-3","text-center"],[1,"ml-3","mt-3",3,"src"],[1,"col-9"],[1,"col-12","font-weight-bold"]],template:function(t,n){1&t&&(e.j41(0,"ion-header")(1,"div",0)(2,"span",1),e.EFF(3,"Liste des v\xe9hicules"),e.k0s(),e.DNE(4,Sn,1,0,"ion-icon",2),e.k0s(),e.j41(5,"div")(6,"ion-searchbar",3),e.bIt("ionClear",function(){return n.onClearSearch()})("keyup.enter",function(l){return n.handleSearch(l)}),e.k0s()()(),e.j41(7,"ion-content",4)(8,"ion-refresher",5),e.bIt("ionRefresh",function(l){return n.handleRefresh(l)}),e.nrm(9,"ion-refresher-content"),e.k0s(),e.j41(10,"div",6),e.DNE(11,xn,6,1,"ion-grid",7),e.j41(12,"div",8),e.DNE(13,Dn,1,1,"app-vehicle-card",9),e.k0s(),e.j41(14,"ion-infinite-scroll",10),e.bIt("ionInfinite",function(l){return n.loadData(l)}),e.nrm(15,"ion-infinite-scroll-content",11),e.k0s(),e.DNE(16,Rn,23,11,"ion-card",12),e.k0s()()),2&t&&(e.R7$(4),e.Y8G("ngIf",(null==n.env||null==n.env.vehicleOperations?null:n.env.vehicleOperations.addVehicle)&&n.gs.checkPermission("o_add_product")),e.R7$(7),e.Y8G("ngIf",0===(null==n.vehicles?null:n.vehicles.length)),e.R7$(2),e.Y8G("ngForOf",n.vehicles),e.R7$(3),e.Y8G("ngForOf",n.vehicles))},dependencies:[y.Sq,y.bT,_.Jm,_.b_,_.hU,_.W9,_.lO,_.eU,_.iq,_.KW,_.Ax,_.Hp,_.uz,_.he,_.To,_.Ki,_.ln,_.S1,_.IO,_.Gw,In]}),s})();const Pn=[{path:"",component:(()=>{var i;class s{constructor(){}ngOnInit(){}}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275cmp=e.VBU({type:i,selectors:[["app-vehicles"]],decls:6,vars:2,consts:[[3,"translucent"],[3,"fullscreen"]],template:function(t,n){1&t&&(e.j41(0,"ion-header",0)(1,"ion-toolbar")(2,"ion-title"),e.EFF(3,"Vehicles"),e.k0s()()(),e.j41(4,"ion-content",1),e.nrm(5,"app-cars"),e.k0s()),2&t&&(e.Y8G("translucent",!0),e.R7$(4),e.Y8G("fullscreen",!0))},dependencies:[_.W9,_.eU,_.BC,_.ai,Tn],styles:["ion-content[_ngcontent-%COMP%]{--background: #f4f5f8}"]}),s})()}];let Vn=(()=>{var i;class s{}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[ce.iI.forChild(Pn),ce.iI]}),s})(),An=(()=>{var i;class s{}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[y.MD,_.bv]}),s})(),Gn=(()=>{var i;class s{}return(i=s).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[y.MD,u.YN,_.bv,Vn,u.X1,An]}),s})()}}]);